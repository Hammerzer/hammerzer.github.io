<!DOCTYPE html><html lang="zh-CN"><head><script src="https://lib.sinaapp.com/js/jquery/1.7.2/jquery.min.js"></script><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="apple-touch-icon" sizes="180x180" href="/images/180-180.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/32-32.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/16-16.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/pace-js@1/themes/blue/pace-theme-minimal.css"><script src="//cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"hammerzer.github.io",root:"/",scheme:"Gemini",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:"flat"},back2top:{enable:!0,sidebar:!0,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:"valine",storage:!0,lazyload:!1,nav:null,activeClass:"valine"},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="CONTENT OUTLINE  Qt必备  〇 目录 Qt入门第一步 Qt开发必备的知识储备 常用控件和类 QA"><meta property="og:type" content="article"><meta property="og:title" content="Qt快速入门"><meta property="og:url" content="https://hammerzer.github.io/2024/07/16/qt-Quick-Start/index.html"><meta property="og:site_name" content="Moustache&#39;s Blog"><meta property="og:description" content="CONTENT OUTLINE  Qt必备  〇 目录 Qt入门第一步 Qt开发必备的知识储备 常用控件和类 QA"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://hammerzer.github.io/.io//1-1.png"><meta property="og:image" content="https://hammerzer.github.io/.io//2-1.png"><meta property="og:image" content="https://hammerzer.github.io/.io//2-2.png"><meta property="og:image" content="https://hammerzer.github.io/.io//2-3.png"><meta property="og:image" content="https://hammerzer.github.io/.io//2-4.png"><meta property="og:image" content="https://hammerzer.github.io/.io//2-5.png"><meta property="og:image" content="https://hammerzer.github.io/.io//2-6.png"><meta property="og:image" content="https://hammerzer.github.io/.io//2-7.png"><meta property="og:image" content="https://hammerzer.github.io/.io//2-8.png"><meta property="og:image" content="https://hammerzer.github.io/.io//2-9.png"><meta property="og:image" content="https://hammerzer.github.io/.io//3-1.png"><meta property="og:image" content="https://hammerzer.github.io/.io//3-2.png"><meta property="og:image" content="https://hammerzer.github.io/.io//3-3.png"><meta property="og:image" content="https://hammerzer.github.io/.io//3-4.png"><meta property="og:image" content="https://hammerzer.github.io/.io//3-5.png"><meta property="og:image" content="https://hammerzer.github.io/.io//3-6.png"><meta property="og:image" content="https://hammerzer.github.io/.io//3-7.png"><meta property="og:image" content="https://hammerzer.github.io/.io//3-8.png"><meta property="og:image" content="https://hammerzer.github.io/.io//3-9.png"><meta property="og:image" content="https://hammerzer.github.io/.io//3-10.png"><meta property="og:image" content="https://hammerzer.github.io/.io//3-11.png"><meta property="og:image" content="https://hammerzer.github.io/.io//3-12.png"><meta property="og:image" content="https://hammerzer.github.io/.io//3-13.png"><meta property="og:image" content="https://hammerzer.github.io/.io//3-14.png"><meta property="og:image" content="https://hammerzer.github.io/.io//3-15.png"><meta property="article:published_time" content="2024-07-16T03:19:36.000Z"><meta property="article:modified_time" content="2025-01-19T03:19:15.858Z"><meta property="article:author" content="Moustache"><meta property="article:tag" content="操作系统与框架"><meta property="article:tag" content="Qt"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://hammerzer.github.io/.io//1-1.png"><link rel="canonical" href="https://hammerzer.github.io/2024/07/16/qt-Quick-Start/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>Qt快速入门 | Moustache's Blog</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="Moustache's Blog" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">Moustache's Blog</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">小胡子的私人空间</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">34</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">9</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">78</span></a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="reading-progress-bar"></div><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://hammerzer.github.io/2024/07/16/qt-Quick-Start/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/180-180.png"><meta itemprop="name" content="Moustache"><meta itemprop="description" content="我是小胡子"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Moustache's Blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Qt快速入门</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2024-07-16 11:19:36" itemprop="dateCreated datePublished" datetime="2024-07-16T11:19:36+08:00">2024-07-16</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2025-01-19 11:19:15" itemprop="dateModified" datetime="2025-01-19T11:19:15+08:00">2025-01-19</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CPP/" itemprop="url" rel="index"><span itemprop="name">CPP</span></a> </span></span><span id="/2024/07/16/qt-Quick-Start/" class="post-meta-item leancloud_visitors" data-flag-title="Qt快速入门" title="阅读次数"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">阅读次数：</span> <span class="leancloud-visitors-count"></span> <span>℃</span> </span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">阅读次数：</span> <span id="busuanzi_value_page_pv"></span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i> </span><span class="post-meta-item-text">Valine：</span> <a title="valine" href="/2024/07/16/qt-Quick-Start/#valine-comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/2024/07/16/qt-Quick-Start/" itemprop="commentCount"></span></a></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>54k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>49 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="CONTENT-OUTLINE"><a href="#CONTENT-OUTLINE" class="headerlink" title="CONTENT OUTLINE"></a>CONTENT OUTLINE</h2><blockquote><p><span style="background:#ff0">Qt必备</span></p></blockquote><h2 id="〇-目录"><a href="#〇-目录" class="headerlink" title="〇 目录"></a>〇 目录</h2><ul><li><code>Qt</code>入门第一步</li><li>Qt开发必备的知识储备</li><li>常用控件和类</li><li>QA</li></ul><span id="more"></span><br><hr style="border:0;height:1px;background:#333;background-image:linear-gradient(to right,#ccc,#333,#ccc)"><hr style="border-top:1px dashed #8c8b8b;border-bottom:none"><h2 id="一-Qt入门第一步"><a href="#一-Qt入门第一步" class="headerlink" title="一 Qt入门第一步"></a>一 <code>Qt</code>入门第一步</h2><h3 id="1-1-Qt-基本简介"><a href="#1-1-Qt-基本简介" class="headerlink" title="1.1 Qt 基本简介"></a>1.1 <code>Qt</code> 基本简介</h3><p>QT是一个<strong>跨平台</strong>的C++图形用户界面<strong>应用程序框架</strong>【嵌入式Linux、Windows、Andriod、iOS等】。</p><ul><li>它为程序开发者提供图形界面所需的所有功能。</li><li>它是完全面向对象的，很容易扩展，并且允许真正地组件编程。</li></ul><h4 id="1-1-1-Qt的发展"><a href="#1-1-1-Qt的发展" class="headerlink" title="1.1.1 Qt的发展"></a>1.1.1 Qt的发展</h4><ul><li>1991年最早由奇趣科技公司【瑞典】开发。</li><li>1996年开始进入商业领域，MatthiasEttrich【马蒂亚斯·埃特里希】创建KDE项目。</li><li>2008年Qt被诺基亚收购。成为诺基亚旗下的编程语言。</li><li>2012年Qt又被Digia公司收购</li><li>2014年发布跨平台的集成开发环境Qt Create 3.1.0。同年又发布了5.3正式版，支持了对目前主流平台的支持：如iOS、Android、<del>WP(Windows Phone)</del>等移动平台。</li></ul><h4 id="1-1-2-支持平台"><a href="#1-1-2-支持平台" class="headerlink" title="1.1.2 支持平台"></a>1.1.2 支持平台</h4><ul><li>Windows ： XP 、 Vista、Win7、win8、win2008、win10</li><li>Unix/Linux：Ubuntu等Linux发行版本【需要桌面版，而不是命令行版本】</li><li>Macintosh（苹果） ：Mac OS X</li><li>Embedded（嵌入式） - 有帧缓冲(framebuffer)支持的嵌入式Linux平台，Windows CE</li></ul><h4 id="1-1-3-Qt的版本"><a href="#1-1-3-Qt的版本" class="headerlink" title="1.1.3 Qt的版本"></a>1.1.3 Qt的版本</h4><p>Qt按不同的版本发型，分为商业版和开源版。</p><ul><li>商业版：为商业软件开发，他们提供传统商业软件发行版，并且提供在商业有效期内的免费升级和技术支持服务。</li><li>开源版：为了开发自由而设计的源码软件，它提供了和商业版本同样的功能，在GNU通用公共许可下，它是免费的。</li></ul><h4 id="1-1-4-Qt-Creator"><a href="#1-1-4-Qt-Creator" class="headerlink" title="1.1.4 Qt Creator"></a>1.1.4 Qt Creator</h4><p>Qt Creator是一个用于Qt开发的轻量级跨平台集成开发环境。</p><p>Qt Creator可带来两大关键益处：</p><ul><li>提供首个专为支持跨平台开发而设计的集成开发环境 (IDE)，并确保首次接触Qt框架的开发人员能迅速上手和操作。</li><li>即使不开发Qt应用程序，Qt Creator也是一个简单易用且功能强大的IDE。【Python也可以开发Qt，但都被封装成包，这是基于Python可以导入C++库】</li></ul><h4 id="1-1-5-Qt的优点"><a href="#1-1-5-Qt的优点" class="headerlink" title="1.1.5 Qt的优点"></a>1.1.5 Qt的优点</h4><ol><li>优良的跨平台特性，几乎支持所有的平台【需要更改的点：如不同平台下的路径符号、盘符分区】</li><li>接口简单，容易上手，学习Qt框架对学习其他框架有参考意义【也就是说，对不同操作系统底层接口做了不同的封装】</li><li>面相对象，模块化程度非常高，可重用性好，对于用户开发来说非常方便</li><li>丰富的API</li><li>有大量的开发文档</li><li>可以进行嵌入式开发</li></ol><br><h3 id="1-2-Qt5的安装"><a href="#1-2-Qt5的安装" class="headerlink" title="1.2 Qt5的安装"></a>1.2 Qt5的安装</h3><h4 id="1-2-1-下载Qt5"><a href="#1-2-1-下载Qt5" class="headerlink" title="1.2.1 下载Qt5"></a>1.2.1 下载Qt5</h4><ol><li>Qt的离线下载地址，打开浏览器，输入该地址进入下载页面：<a target="_blank" rel="noopener" href="http://download.qt.io/%E3%80%90%E6%8E%A8%E8%8D%90%E5%AE%98%E7%BD%91%E4%B8%8B%E8%BD%BD%E3%80%91">http://download.qt.io/【推荐官网下载】</a></li><li>在页面选择点击archive目录</li><li>选择Qt</li><li>点开后会有很多的版本可以够选择，我这教程这则用5.12版本</li><li>在选则5.12.9版本</li><li>选择就可以看到有各个平台下的Qt，我们现在使用Windows开发，我们就选择Windows平台下的开发工具。这里只有X86的，其实它是将X86和X64集成在一起了。</li></ol><blockquote><p>上面的流程比较老了，新的流程如下</p></blockquote><p>产品<a target="_blank" rel="noopener" href="https://www.qt.io/download-dev">下载页面</a>-&gt; Community User：Qt for Open Source Development…</p><p>选择组件：</p><br><h4 id="1-2-2-Qt安装"><a href="#1-2-2-Qt安装" class="headerlink" title="1.2.2 Qt安装"></a>1.2.2 Qt安装</h4><ol><li>断网，安装前建议先断网，不然软件会提示让你先注册，这玩意麻烦，断网了就可以跳过。</li><li>首先点击下一步，然后按图方式跳过，再下一步。</li><li>选择安装路径，一般来说最好用默认路径，而且这个路径一定要记住，在以后的开发过程中，还会用到。</li><li>选择安装项：在Windows下，我们选择使用Windows开发的编译工具来开发会好一些，也方便一些。点击下一步，等待安装完成。选择一个32位的版本和一个64位的版本，Sources是源码，建议勾选，有的时候，可以通过看源码，了解更多Qt的原理。Tools中是一个Debug调试工具。</li><li>接下来就是漫长的等待</li></ol><br><h3 id="1-3-编写Qt的第一个程序"><a href="#1-3-编写Qt的第一个程序" class="headerlink" title="1.3 编写Qt的第一个程序"></a>1.3 编写Qt的第一个程序</h3><h4 id="1-3-1-新建项目"><a href="#1-3-1-新建项目" class="headerlink" title="1.3.1 新建项目"></a>1.3.1 新建项目</h4><ol><li>鼠标点击文件&gt; 新建文件或项目，弹出新建项目对话框。在项目里选择application，在右边框中选择<code>Qt Widgets Application</code>。单击右下角【选择】。</li><li>在项目介绍和位置中，输入自己的项目名称，项目的位置，由自己决定。【为了减少错误，尽量使用全英文的路径】点击下一步。</li><li><code>Build System</code> 选择qMake。【CMake是当可能做迁移，且迁移平台是Linux系统】</li><li><code>Class Information</code> 默认选择<code>QMainWindow</code>。</li><li>集成工具箱的选择，在<code>kit selection</code>中选择 MSVC已检测到的x64版本，或者MinGW，再点击下一步。</li><li>项目管理，我们暂时用不到，直接点击完成。</li><li>项目就已经建立好，qt开发环境就已经帮我把所有的文件都已经建立好了。</li></ol><h4 id="1-3-2-编辑模式"><a href="#1-3-2-编辑模式" class="headerlink" title="1.3.2 编辑模式"></a>1.3.2 编辑模式</h4><p>其实是一些xml代码。</p><h4 id="1-3-3-设计模式"><a href="#1-3-3-设计模式" class="headerlink" title="1.3.3 设计模式"></a>1.3.3 设计模式</h4><p>就是可视化，修改即所得的界面。</p><h4 id="1-3-4-运行项目"><a href="#1-3-4-运行项目" class="headerlink" title="1.3.4 运行项目"></a>1.3.4 运行项目</h4><p>在开发界面左下角有三个图标：运行、调试、构建。【直接点击运行，项目会自动构建并运行】</p><blockquote><p>很简洁的一个界面，什么也没有，就一个对话框，一个最小、大、关闭按钮。</p></blockquote><ul><li><p>修改窗体的标题：在窗体属性的<code>windowTitle</code>修改位：早日迎娶白富美</p></li><li><p>从左侧的工具箱中找到<code>pushbutton</code> ，用鼠标点击拖动到编辑界面后松手，然后可以调整按钮的大小；单击按钮可以在属性框中可以修改按钮的属性。</p></li><li><p>找到<code>QAbstractButton</code>属性下的text，将其修改为：开启逆袭。【修改后，可视化界面当中的按钮中的文字就已经发生变化】</p></li><li><p>接下来我们右击该按钮 &gt; 转到槽【即点击事件】，选择单击信号 <code>clicked()</code> 并点击ok。接下来程序会自动跳转到槽信号处理函数中来。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QMessageBox&gt;</span><span class="comment">//在该文件的头文件添加</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//在槽信号函数中添加</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MainWindow::on_pushButton_clicked</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//Information代表图标</span></span><br><span class="line">    QMessageBox::<span class="built_in">information</span>(<span class="keyword">this</span>,<span class="string">&quot;恭喜&quot;</span>,<span class="string">&quot;您以成功逆袭，请点击迎娶白富美！&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p><img src="/.io//1-1.png"></p><blockquote><p>到此，完成了一个简单的QT图形界面的小项目。</p></blockquote><br><h3 id="1-4-Qt项目文件介绍"><a href="#1-4-Qt项目文件介绍" class="headerlink" title="1.4 Qt项目文件介绍"></a>1.4 Qt项目文件介绍</h3><h4 id="1-4-1-新建工程界面详解"><a href="#1-4-1-新建工程界面详解" class="headerlink" title="1.4.1 新建工程界面详解"></a>1.4.1 新建工程界面详解</h4><ul><li>Application(Qt)：Qt项目，用C++开发。我们所学习都是基于这类项目。</li><li>Application(Qt Quick)：一般是指开发有触摸屏的设备项目，如移动嵌入式设备</li><li>Application(Qt for Python)：是指用创建用Python做开发语言的项目</li><li>Library：库项目<ul><li>C++ Library：在MFC中详解</li><li>Qt Quick 2 Extension Plugin：Qt组件式编程</li><li>Qt Creator Plugin：编辑器插件</li></ul></li><li>其他项目：辅助Qt主项目搭建</li><li>Non-Qt Project：非Qt项目，就仅仅是把Qt Create作为一个开发工具，可以实现和VC6.0一样做命令行C/C++项目</li><li>Import Project：导入一个项目</li></ul><br><blockquote><p>此处学习的只是基于<code>Application(Qt)</code>Qt项目的。所以我们在新建工程的时候，一般都选<code>Qt Widgets Application</code></p></blockquote><ol><li>子项目的选择：<ul><li><code>Qt Widgets Application</code> ：Qt窗体应用程序。创建后就自带基础图形化界面</li><li><code>Qt Console Application</code>：Qt控制台应用程序，预先不带窗体，但可以通过代码创建并显示窗体。</li></ul></li><li>选择项目名和项目路径</li><li>选择编译系统，默认qmake即可。</li><li><code>Class Information</code> 类信息选择：<ul><li>Class name: 类名，就是我们做最基本项目，所需要创建一个类的名字。</li><li>Base class：基类，这个我们有三个基类详细介绍：<ul><li><code>QMainWindows</code>：窗口应用，可添加Windows控件就使用QMainWindows基类</li><li><code>QWidget</code>：基本窗体类，比如我们上节课讲到的第一个程序示例。只有简单的一个窗体，有最大化、最小化，加上一个按钮。</li><li><code>QDialog</code>：对话框基类，此类界面叫对话框。就于用户交互的一种基本界面，如我们选择项目先择的地方就是一个对话框</li></ul></li><li>myWidget：是我命名的一个类名，只需要修改这一个，下面的头文件，和源文件，还有资源文件，ui文件，都会跟着一起重命名。所以不需要手动修改。</li><li>Generate form：就是创建界面文件【在没有学会怎么用代码创建窗口的时候，我们还是先勾选】</li></ul></li><li>翻译文件【目前用不到】</li><li>开发工具包的选择：这个是在我们安装Qt的时候确定了的，其实也就是编译器。<ul><li>MSVC：是微软开发的编译环境，我们使用Windows操作系统做开发，理论来说，用微软自己的编译环境出现不明错误和bug的机会会少一点。</li><li>我们都知道32位的操作系统和应用程序，最大寻址范围只有4G；但是我们学习开发，一般都是很小的程序或者小项目，基本上是用不到4G内存以上的，所以我们直接选择32的MSVC编译环境。</li></ul></li><li>项目管理：这个功能是用于在多人合作共同开发项目，还有版本的迭代和回滚所需要的一个功能【目前的学习还用不到此功能，所以直接不用配置，直接选择none】【需要用到时，一般来说有三种：git，vss，svn】</li><li>单击完成。</li></ol><br><h4 id="1-4-2-项目文件详解"><a href="#1-4-2-项目文件详解" class="headerlink" title="1.4.2 项目文件详解"></a>1.4.2 项目文件详解</h4><p><code>mian.cpp</code>：主函数所在的文件，应用程序的入口。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;mainwindow.h&quot;</span>    <span class="comment">//mainwindow为自定义类名/项目名</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QApplication&gt;</span><span class="comment">//Qt应用程序头文件</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QLocale&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QTranslator&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">QApplication <span class="title">a</span><span class="params">(argc, argv)</span></span>;<span class="comment">//声明一个应用</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//国际化【字符集】</span></span><br><span class="line">    QTranslator translator;</span><br><span class="line">    <span class="type">const</span> QStringList uiLanguages = QLocale::<span class="built_in">system</span>().<span class="built_in">uiLanguages</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">const</span> QString &amp;locale : uiLanguages) &#123;</span><br><span class="line">        <span class="type">const</span> QString baseName = <span class="string">&quot;HelloQt_&quot;</span> + <span class="built_in">QLocale</span>(locale).<span class="built_in">name</span>();</span><br><span class="line">        <span class="keyword">if</span> (translator.<span class="built_in">load</span>(<span class="string">&quot;:/i18n/&quot;</span> + baseName)) &#123;</span><br><span class="line">            a.<span class="built_in">installTranslator</span>(&amp;translator);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    MainWindow w;<span class="comment">//声明主窗口【MainWindow为自定义类】</span></span><br><span class="line">    w.<span class="built_in">show</span>();<span class="comment">//显示</span></span><br><span class="line">    <span class="keyword">return</span> a.<span class="built_in">exec</span>();<span class="comment">//开启消息循环的队列</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>mainwindow.h</code> 类头文件</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> MAINWINDOW_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAINWINDOW_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QMainWindow&gt;</span></span></span><br><span class="line"></span><br><span class="line">QT_BEGIN_NAMESPACE</span><br><span class="line"><span class="keyword">namespace</span> Ui &#123;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MainWindow</span>;</span><br><span class="line">&#125;</span><br><span class="line">QT_END_NAMESPACE</span><br><span class="line"></span><br><span class="line"><span class="comment">//MainWindow为自定义类名</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MainWindow</span> : <span class="keyword">public</span> QMainWindow    <span class="comment">//基于QMainWindow的派生类</span></span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">MainWindow</span>(QWidget *parent = <span class="literal">nullptr</span>);</span><br><span class="line">    ~<span class="built_in">MainWindow</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> slots:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">on_pushButton_clicked</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Ui::MainWindow *ui;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// MAINWINDOW_H</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p><strong>值得注意的是</strong>：<code>Q_OBJECT</code> 【信号和槽】是Qt应用开发的基础，它将两个毫无关系的对象连接在一起。</p><p>槽和普通的C++函数是一样的，只是当它和信号连接在一起后，当发送信号的时候，槽会自动被调用，且只有加入了<code>Q_OBJECT</code>，你才能使用QT中的<code>signal</code>和<code>slot</code>机制。【单独详细讲解】</p></blockquote><p><code>mainwindow.cpp</code> 文件</p><ul><li><code>parent</code> : 指向父类的一个指针</li><li><code>QMainWindow(parent)</code> 构造一个QMainWindow对象</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;mainwindow.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ui_mainwindow.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QMessageBox&gt;</span></span></span><br><span class="line"></span><br><span class="line">MainWindow::<span class="built_in">MainWindow</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">QMainWindow</span>(parent)</span><br><span class="line">    , <span class="built_in">ui</span>(<span class="keyword">new</span> Ui::MainWindow)</span><br><span class="line">&#123;</span><br><span class="line">    ui-&gt;<span class="built_in">setupUi</span>(<span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MainWindow::~<span class="built_in">MainWindow</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">delete</span> ui;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MainWindow::on_pushButton_clicked</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//Information代表图标</span></span><br><span class="line">    QMessageBox::<span class="built_in">information</span>(<span class="keyword">this</span>,<span class="string">&quot;恭喜&quot;</span>,<span class="string">&quot;您以成功逆袭，请点击迎娶白富美！&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>mainwindow.ui</code> ：UI界面文件，之后一一讲解。</p><p><code>Qtest.pro</code> 文件：类似于visual studio 种的 sln 文件，管理本项目的一个文件，记录本项目的编译选项，参数等。如：源文件信息，配置信息，头文件、ui文件，qmake信息，跟makefile类似。</p><br><h4 id="1-4-3-调试器问题"><a href="#1-4-3-调试器问题" class="headerlink" title="1.4.3 调试器问题"></a>1.4.3 调试器问题</h4><p>可能会遇到调试器问题，发现调试器无法工作，这是因为 <code>win10 SDK</code> 默认是没有安装调试工具的。故需要我们手动安装一下调试工具。</p><ol><li>在Windows设置，选择应用的安装与卸载</li><li>找到<code>win10 SDK</code>的版本：Maintain your Windows Software Development Kit - Windows10.0.22000.832 features</li><li>点击<code>Change</code>修改，勾选`Debugging Tools for Windwos，然后点击Change。如果顺利，则会自动安装。</li></ol><br><h3 id="1-5-Qt-Creator快捷键"><a href="#1-5-Qt-Creator快捷键" class="headerlink" title="1.5 Qt Creator快捷键"></a>1.5 Qt Creator快捷键</h3><p>单键快捷键</p><table><thead><tr><th>快捷键</th><th>含义</th></tr></thead><tbody><tr><td>🔺F1</td><td>打开帮助手册</td></tr><tr><td>🔺F2</td><td>在函数声明与实现之间切换</td></tr><tr><td>F4</td><td>在 cpp 和 .h 文件切换</td></tr></tbody></table><p>Ctrl组合快捷键</p><table><thead><tr><th>快捷键</th><th>含义</th></tr></thead><tbody><tr><td>🔺Ctrl+鼠标左键</td><td>同F2快捷键功能相同</td></tr><tr><td>🔺Ctrl+L</td><td>跳到某一行</td></tr><tr><td>Ctrl + Shift + F</td><td>在项目/文件夹下查找（可能跟搜狗输入法冲突）</td></tr><tr><td>🔺Ctrl+i</td><td>代码自动对齐</td></tr><tr><td>Ctrl+Tab</td><td>快速切换已打开的文件</td></tr><tr><td>🔺Ctrl+/</td><td>快速注释或取消注释</td></tr><tr><td>🔺Ctrl+Enter</td><td>在当前行的下方插入空白行</td></tr><tr><td>🔺Ctrl+Shift+Enter</td><td>到上一行添加空白行</td></tr><tr><td>Ctrl+],Ctrl+[</td><td>跳到程序段结尾 或者开头</td></tr><tr><td>🔺Ctrl+D</td><td>删除当前行</td></tr><tr><td>🔺Ctrl+alt+上、下方向键</td><td>复制当前行到上方或下方</td></tr><tr><td>Ctrl+shift+上、下方向键</td><td>移动当前行到上方或下方</td></tr><tr><td>Ctrl+Tab</td><td>快速切换已打开的文件</td></tr><tr><td>Ctrl + Shift + U</td><td>查找所有使用该符号的地方</td></tr><tr><td>Ctrl + Shift + R</td><td>修改变量名，并应用到所有使用该变量的地方</td></tr><tr><td>Ctrl+Shift+&lt;</td><td>折叠代码块</td></tr><tr><td>Ctrl+Shift+&gt;</td><td>展开代码块</td></tr><tr><td>Ctrl +M</td><td>创建书签</td></tr><tr><td>Ctrl + .</td><td>切换书签</td></tr><tr><td>Alt + M</td><td>打开书签栏</td></tr><tr><td>先按Ctrl+e后松开再按0</td><td>删除新建的分栏</td></tr><tr><td>先按Ctrl+e后松开再按1</td><td>删除所有的分栏</td></tr><tr><td>先按Ctrl+e后松开再按2</td><td>添加上下布局的分栏</td></tr><tr><td>先按Ctrl+e后松开再按3</td><td>添加左右布局的分栏</td></tr></tbody></table><p>Shift组合快捷键</p><table><thead><tr><th>快捷键</th><th>含义</th></tr></thead><tbody><tr><td>Shift+delete</td><td>剪切当前行，可以当做删除用</td></tr></tbody></table><p>Alt组合快捷键</p><table><thead><tr><th>快捷键</th><th>含义</th></tr></thead><tbody><tr><td>Alt+左右方向键</td><td>光标返回到上一位置/下一位置</td></tr><tr><td>🔺Alt+Enter</td><td>快速添加方法实体(.cpp)声明</td></tr><tr><td>Alt + 0</td><td>隐藏或显示边栏，编辑模式下起作用（有时写的函数太长，屏幕不够大，就用这个）</td></tr></tbody></table><p>鼠标组合快捷键</p><table><thead><tr><th>快捷键</th><th>含义</th></tr></thead><tbody><tr><td>鼠标选中代码+Tab</td><td>代码右缩进(可多次Tab右缩进)</td></tr><tr><td>鼠标选中代码+Shift+Tab</td><td>代码左缩进(可多次Tab左缩进)</td></tr></tbody></table><br><h3 id="1-6-Qt-Creator代码格式化"><a href="#1-6-Qt-Creator代码格式化" class="headerlink" title="1.6 Qt Creator代码格式化"></a>1.6 Qt Creator代码格式化</h3><br><h2 id="二-Qt开发必备的知识储备"><a href="#二-Qt开发必备的知识储备" class="headerlink" title="二  Qt开发必备的知识储备"></a>二 Qt开发必备的知识储备</h2><h3 id="2-1-QPushButton简介"><a href="#2-1-QPushButton简介" class="headerlink" title="2.1 QPushButton简介"></a>2.1 QPushButton简介</h3><h4 id="2-1-1-创建按钮"><a href="#2-1-1-创建按钮" class="headerlink" title="2.1.1 创建按钮"></a>2.1.1 创建按钮</h4><p>QPushButton是Qt图形界面控件中的一种，是最基本的图形控件之一。在我们的最基本的项目中运行时，是一个空白的窗体，里面什么也没有，那么如何添加一个按钮呢？【从最基本的代码添加按钮】【此处Base Class选择 <code>QWidget</code>】</p><ol><li>要使用<code>QPushButton</code>控件必须先包含：<code>#include &lt;QPushButton&gt;</code>头文件</li><li>new 一个<code>QPushButton</code>对象</li><li>设置该对象的父类为<code>this</code>。【若不设置父类，就是个孤儿，按钮就是独立显示的，而不再上面的方框里，显然不是我们想要的结果，所以我们代码新建的控件，要设置所属】</li><li>三种对<code>QPushButton</code>对象的创建方式<ul><li>局部变量【不推荐，容易内存泄漏】</li><li>全局变量的方式</li><li>在<code>Widget</code>类内声明为私有变量指针【推荐】</li></ul></li></ol><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// widget.cpp</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;widget.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ui_widget.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// #include &lt;QPushButton&gt;</span></span><br><span class="line"><span class="comment">// QPushButton *btn = NULL;</span></span><br><span class="line"></span><br><span class="line">Widget::<span class="built_in">Widget</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">QWidget</span>(parent)</span><br><span class="line">    , <span class="built_in">ui</span>(<span class="keyword">new</span> Ui::Widget)</span><br><span class="line">&#123;</span><br><span class="line">    ui-&gt;<span class="built_in">setupUi</span>(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 从代码添加按钮</span></span><br><span class="line">    <span class="comment">// QPushButton *btn = new QPushButton;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 最好创建为全局变量,并在最后释放，避免内存泄漏</span></span><br><span class="line">    <span class="comment">// btn =new QPushButton;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 更好的方式是在头文件中创建私有变量</span></span><br><span class="line">    btn = <span class="keyword">new</span> QPushButton;</span><br><span class="line">    btn-&gt;<span class="built_in">setParent</span>(<span class="keyword">this</span>);<span class="comment">//this即Widget对话框</span></span><br><span class="line">    btn-&gt;<span class="built_in">setText</span>(<span class="string">&quot;LOL&quot;</span>);</span><br><span class="line"></span><br><span class="line">    btn-&gt;<span class="built_in">show</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Widget::~<span class="built_in">Widget</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">delete</span> ui;</span><br><span class="line">    <span class="comment">// delete btn;// 避免内存泄漏</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/.io//2-1.png" alt="img"></p><br><h4 id="2-1-2-设置按钮参数"><a href="#2-1-2-设置按钮参数" class="headerlink" title="2.1.2 设置按钮参数"></a>2.1.2 设置按钮参数</h4><p>可以看到在左上角，有一个小小的按钮，但按钮里面什么也没，我们可以对这个按钮进行设置，比如调用<code>setText</code>函数就是设置按钮的名字。</p><blockquote><p>在代码提示中，需要一个<code>QString</code> 的对象。此处，我们可以直接使用双引号括起来的字符串，系统会自己强制的转换成QString对象。如：btn-&gt;setText(“英雄联盟”);</p></blockquote><p>可以看到整个按钮上就有了“英雄联盟”的字样。但感觉按钮太小，字很紧凑。故再对按钮进行调整：</p><ul><li>调整大小</li><li>调整位置</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;widget.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ui_widget.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">Widget::<span class="built_in">Widget</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">QWidget</span>(parent)</span><br><span class="line">    , <span class="built_in">ui</span>(<span class="keyword">new</span> Ui::Widget)</span><br><span class="line">&#123;</span><br><span class="line">    ui-&gt;<span class="built_in">setupUi</span>(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//btn为Widget类的私有变量</span></span><br><span class="line">    btn = <span class="keyword">new</span> QPushButton;</span><br><span class="line">    btn-&gt;<span class="built_in">setParent</span>(<span class="keyword">this</span>);<span class="comment">//this即Widget对话框</span></span><br><span class="line">    btn-&gt;<span class="built_in">setText</span>(<span class="string">&quot;LOL&quot;</span>);</span><br><span class="line">    btn-&gt;<span class="built_in">resize</span>(<span class="number">160</span>,<span class="number">30</span>);<span class="comment">//设置按钮的大小为宽80，高30</span></span><br><span class="line">    btn-&gt;<span class="built_in">move</span>(<span class="number">80</span>,<span class="number">50</span>);<span class="comment">//以左上角为原点，右为x正方向移动80个像素，下为y正方向移动50个像素</span></span><br><span class="line">    btn-&gt;<span class="built_in">show</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Widget::~<span class="built_in">Widget</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">delete</span> ui;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>运行如图：</p><p><img src="/.io//2-2.png" alt="img"></p><br><h4 id="2-1-3-通过ui文件创建按钮"><a href="#2-1-3-通过ui文件创建按钮" class="headerlink" title="2.1.3 通过ui文件创建按钮"></a>2.1.3 通过ui文件创建按钮</h4><p>首先找到项目的<code>ui</code>文件：<code>widget.ui</code>，双击打开，进入IU编辑的设计模式。</p><ul><li>鼠标左键单击拖动到左侧图形界面，松手，就会在界面上创建一个按钮。</li><li>创建的按钮边上还有8个小点，可以对按钮的大小进行可视化的调整；也可以鼠标拖动到你需要的地方松手即可。</li><li>右下角黄色的背景区域是属性设置框，在其中修改的数据，在可视化界面中，立即就可看到修改后的效果。</li></ul><p><img src="/.io//2-3.png" alt="img"></p><p>下面介绍一些比较常用的参数：</p><ul><li><code>ObjectName</code>：对象名，这个是在属性框中是不可以修改的。但可以右击按钮&gt;修改对象名称。</li><li><code>Enbled</code>：是否启用该按钮【如果不启用，整个按钮为灰色，处于不可点击的状态】</li><li><code>Geometry</code>：几何参数，(170,230)是位置坐标，80x20是按钮的大小</li><li><code>Palette</code> ：调色盘，这里直接继承父类的颜色</li><li><code>stylesheet</code>：【添加颜色】下选择color和background-color</li><li><code>Font</code>：字体参数</li><li><code>Cursor</code>： 光标 ，是指鼠标移动到该按钮上的光标样式。</li><li><code>Text</code>：按钮的文本显示</li><li><code>Icon</code>：按钮的图标，按钮可以内嵌图标</li></ul><p><img src="/.io//2-4.png" alt="img"></p><br><h3 id="2-2-帮助文档：Qt助手的使用"><a href="#2-2-帮助文档：Qt助手的使用" class="headerlink" title="2.2 帮助文档：Qt助手的使用"></a>2.2 帮助文档：Qt助手的使用</h3><p>打开Qt助手：点击系统开始输入：<code>assistant</code>，打开Qt助手。</p><blockquote><p>我们可以通过帮助文档，学习Qt，助手中有所有类、控件，方法的介绍，对我们学习Qt，查询方法使用，有很大的帮助。</p></blockquote><p>如：搜索<code>QPushButton</code>类，来看看帮助文档里有什么？</p><h4 id="查找索引"><a href="#查找索引" class="headerlink" title="查找索引"></a>查找索引</h4><p><img src="/.io//2-5.png"></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//在使用之前，必须包含该头文件</span></span><br><span class="line">Header:  <span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QPushButton&gt;</span>            </span></span><br><span class="line">CMake: <span class="built_in">find_package</span>(Qt6 REQUIRED COMPONENTS Widgets) </span><br><span class="line"><span class="built_in">target_link_libraries</span>(mytarget PRIVATE Qt6::Widgets)</span><br><span class="line"></span><br><span class="line"><span class="comment">//在编译的时候，在pro文件中必须加入widgets模块，但这个是基础模块，默认加入的[.pro文件可见]</span></span><br><span class="line"><span class="comment">//但若我们需要学习tcp网络的时候，需要使用QTcpSocket类，那么就还需要在.pro文件中添加 network模块 不然是无法使用网络的。</span></span><br><span class="line">qmake: QT += widgets</span><br><span class="line">    </span><br><span class="line"><span class="comment">//该类是继承了QAbstractButton类，即它的父类</span></span><br><span class="line">Inherits: QAbstractButton</span><br><span class="line">    </span><br><span class="line"><span class="comment">//谁继承它</span></span><br><span class="line">Inherited By: QCommandLinkButton</span><br><span class="line"></span><br><span class="line"><span class="comment">//除了这些继承关系，还有一些该类的公开的、保护的，私有的一些方法</span></span><br></pre></td></tr></table></figure><br><h3 id="2-3-Qt对象树的概念"><a href="#2-3-Qt对象树的概念" class="headerlink" title="2.3 Qt对象树的概念"></a>2.3 Qt对象树的概念</h3><h4 id="什么是对象树？"><a href="#什么是对象树？" class="headerlink" title="什么是对象树？"></a>什么是对象树？</h4><p>Qt中的 <code>Q_Object</code> 会用对象树来组织管理自己，那什么是对象树？</p><p>这个概念非常好理解。因为 <code>QObject</code> 类就有一个私有变量 <code>QList&lt;QObject *&gt;</code>，专门存储这个类的子孙后代。比如创建一个 <code>QObject</code> 并指定父对象时，就会把自己加入到父对象的 <code>children()</code> 列表中，也就是 <code>QList&lt;QObject *&gt;</code> 变量中。</p><p>从<code>2.1</code>节代码中可以看出，我们每new一个对象，都会给他指定一个父亲，而这个mywidget这个窗体，在构造的收也都要指定一个父亲，就是<code>QWidget</code>。</p><blockquote><p>所以这里面的关系就是，QWidget 是myWidget的父亲，myWidget又是btn的父亲。</p></blockquote><br><h4 id="使用对象树模式有什么好处？"><a href="#使用对象树模式有什么好处？" class="headerlink" title="使用对象树模式有什么好处？"></a>使用对象树模式有什么好处？</h4><p>好处就是：<span style="background:#ff0">当父对象被析构时，子对象也会被析构</span>【从一定程度上讲，简化了内存回收机制】</p><p>▲其析构为递归方式：即先析构父对象，与此同时，发现有子对象存在，故转而析构子对象，以此类推，直至全部析构完毕。</p><blockquote><p>举个例子：有一个窗口 Window，里面有 Label标签、TextEdit文本输入框、Button按钮这三个元素，并且都设置 Window 为它们的父对象。</p><p>这时候我做了一个关闭窗口的操作，作为程序员的你是不是自然想到将所有和窗口相关的对象析构啊？古老的办法就是一个个手动 delete 呗。是不是很麻烦？Qt 运用对象树模式，当父对象被析构时，子对象自动就 delete 掉了，不用再写一大堆的代码了。</p></blockquote><p>所以，在我点击该运行程序的<code>X</code>后，系统会根据这个树状的结构，释放掉整个结构的内存。</p><p><img src="/.io//2-6.png"></p><br><h4 id="对象树的问题"><a href="#对象树的问题" class="headerlink" title="对象树的问题"></a>对象树的问题</h4><p>如果子对象，由于系统机制，会自动释放；那么可能存在一个问题，子对象可能被二次释放，导致崩溃。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;widget.h&quot;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QApplication&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">QApplication <span class="title">a</span><span class="params">(argc, argv)</span></span>;</span><br><span class="line">    </span><br><span class="line">    QPushButton button;    <span class="comment">// 在主函数中新建按钮，并直接绑定在顶层widget上</span></span><br><span class="line">    Widget w;</span><br><span class="line">    button.<span class="built_in">setParent</span>(&amp;w);</span><br><span class="line">    button.<span class="built_in">setText</span>(<span class="string">&quot;崩溃之源&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    w.<span class="built_in">show</span>();</span><br><span class="line">    <span class="keyword">return</span> a.<span class="built_in">exec</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在上面的主函数中，<span style="background:#cfff00">局部变量【<code>button</code> / w<code>】</code>都是定义在栈上的。当主函数结束返回时，会销毁栈，而栈的销毁方式是先进后出，故先析构<code>w</code>，再析构<code>button</code></span>【但<code>button</code>绑定在<code>w</code>上，析构<code>w</code>会自动析构<code>button</code>，故会导致二次析构，导致奔溃】</p><blockquote><p>运行程序后，关闭窗口时报错，或直接跳转到错误代码。</p><p><span style="background:#ff0">一般的报错情况是：会提示错误在heap上【堆】，因为Button上的内容都是在堆上用new生成的，故二次释放首先会delete堆上的数据，但本质是栈上的析构引起的。</span></p></blockquote><p><span style="background:#bfff00">修正</span>：将 <code>QPushButton button;</code> 定义在<code>Widget w;</code> 之后。【当析构Widget时，遇到无效子对象时，直接跳过】</p><br><h3 id="2-4-🔺Qt中信号和槽"><a href="#2-4-🔺Qt中信号和槽" class="headerlink" title="2.4 🔺Qt中信号和槽"></a>2.4 🔺Qt中信号和槽</h3><p>信号与槽（<code>Signal &amp; Slot</code>）是 Qt 编程的基础，也是 Qt 的一大创新。</p><p>因为有了信号与槽的编程机制，在 Qt 中处理界面各个组件的交互操作时变得更加直观和简单。它可以让应用程序编程人员把这些互不了解的对象绑定在一起。</p><h4 id="2-4-1-信号【Signal】"><a href="#2-4-1-信号【Signal】" class="headerlink" title="2.4.1 信号【Signal】"></a>2.4.1 信号【Signal】</h4><p>信号（Signal）就是在特定情况下被发射的事件。例如 <code>PushButton</code> 最常见的信号就是鼠标单击时发射的 <code>clicked()</code> 信号；一个 <code>ComboBox</code> 最常见的信号是选择的列表项变化时发射的 <code>CurrentIndexChanged()</code> 信号。</p><p><code>GUI</code> 程序设计的主要内容就是对界面上各组件的信号的响应，只需要知道什么情况下发射哪些信号，合理地去响应和处理这些信号就可以了。</p><br><h4 id="2-4-2-槽【Slot】"><a href="#2-4-2-槽【Slot】" class="headerlink" title="2.4.2 槽【Slot】"></a>2.4.2 槽【Slot】</h4><p>槽，就是对应响应信号的函数。</p><ul><li>槽就是一个函数，与一般的C++函数是一样的，可以定义在类的任何部分【<code>public</code>、<code>private</code> 或 <code>protected</code>】，可以具有任何参数，也可以被直接调用【即不一定必须要信号来触发槽，而是可以直接调用槽函数】。</li><li>槽函数与一般的函数不同的是：槽函数可以与一个信号关联，当信号被发射时，关联的槽函数被自动执行。</li></ul><p><span style="background:#ff0">信号与槽关联</span>是用 <code>QObject::connect()</code> 函数实现的，其基本格式是：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">QObject::<span class="built_in">connect</span>(sender, <span class="built_in">SIGNAL</span>(<span class="built_in">signal</span>()), receiver, <span class="built_in">SLOT</span>(<span class="built_in">slot</span>()));</span><br><span class="line"><span class="comment">//参数1、信号的发送者</span></span><br><span class="line"><span class="comment">//参数2、发送的信号</span></span><br><span class="line"><span class="comment">//参数3、信号的接收者</span></span><br><span class="line"><span class="comment">//参数4、处理函数（槽函数）</span></span><br></pre></td></tr></table></figure><br><p>【案例】现在，点击英雄联盟整个按钮没有任何反应。现在，实现【点击该按钮，关闭窗口】的功能。那么，就得给他们之间建立信号与槽的联系。</p><blockquote><p>理解：按钮接收一个鼠标单击的信号，窗口就执行关闭函数。</p><p><img src="/.io//2-7.png"></p></blockquote><br><p>① 首先我们查看按钮QPushButton可以接收哪些信号？</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">clicked</span><span class="params">(<span class="type">bool</span> checked = <span class="literal">false</span>)</span>        <span class="comment">//单机信号</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pressed</span><span class="params">()</span>                            <span class="comment">//鼠标按下</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">released</span><span class="params">()</span>                        <span class="comment">//鼠标松开</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">toggled</span><span class="params">(<span class="type">bool</span> checked)</span>                <span class="comment">//开关信号</span></span></span><br></pre></td></tr></table></figure><blockquote><p>在<code>QPushButton</code>类中是找不到<code>Signals</code>的，要在他的父类【QAbstractButton class】中查看。</p></blockquote><br><p>② 可以看到QPushButton可以接收四种信号：尝试使用第一个【单击信号】，实现单击按钮关闭窗口</p><p>③ 关闭窗口，哪个窗口呢？我们自己新建的myWidget窗口，那么我们有实现它的关闭吗？并没有，那么我们需要自己先实现一个吗？不需要。</p><blockquote><p>myWidget类【即示例代码中的 <code>Widget</code> 类】，其实是<code>QWidget</code>的子类。</p><p>查看帮助文档看看<code>QWidget</code>，在<code>Public Slots</code>种找，第一个就是<code>close</code>函数，就是关闭窗体的实现。</p></blockquote><p>④ 现在我们凑齐了实现信号槽的四个要素：信号发送者是按钮【new的btn】、发送的信号是clicked单击信号、信号接收者是this【窗口本身】、槽函数是close。接下来让他们。</p><p>⑤ 建立联系：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">QMetaObject::Connection ret = <span class="built_in">connect</span>(btn, &amp;QPushButton::clicked, <span class="keyword">this</span>, &amp;QWidget::close);</span><br><span class="line"><span class="comment">//注意接收的信号：&amp;QPushButton::clicked，而非click【槽函数】</span></span><br></pre></td></tr></table></figure><blockquote><p>注意：信号函数和槽函数前需要加&amp;号</p></blockquote><p>⑥ 编译、执行、点击“英雄联盟”按钮便可以关闭窗口。</p><br><h3 id="2-5-Qt中自定义信号和槽函数"><a href="#2-5-Qt中自定义信号和槽函数" class="headerlink" title="2.5 Qt中自定义信号和槽函数"></a>2.5 Qt中自定义信号和槽函数</h3><blockquote><p>在上节中所用的信号、槽函数都是控件中的类自带的。</p></blockquote><p>那么我们是否可以自定以信号和槽函数呢？按当当然是可以的。</p><h4 id="2-5-1-自定义信号和槽"><a href="#2-5-1-自定义信号和槽" class="headerlink" title="2.5.1 自定义信号和槽"></a>2.5.1 自定义信号和槽</h4><p>首先新建一个项目，项目名称 <code>custom_signal_slot</code>，类名还是<code>MyWidget</code>。在这个的基础上，我们先设定一个需求：</p><ul><li>屌丝男向白富美表白：发送表白信号，白富美接收信号，并回应同意。</li><li>这里面有两个对象，一个屌丝男，一个白富美，我们将使用自定义的信号和槽将他们联系起来。</li></ul><ol><li><p>首先新建两个类，一个屌丝男Boy，一个白富美girl。</p><ol><li>右击项目名 &gt; add new</li><li>选择C++ Class，类名自定义Boy，选择QObject为基类。【为了将此类加入qt children中，而QObject是最基本的基类】以同样的方式创建Girl类。</li></ol></li><li><p>在Boy类的头文件中加入自定义信号的声明【无需实现，由开发环境自动实现，故可直接调用】</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> BOY_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BOY_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QObject&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Boy</span> : <span class="keyword">public</span> QObject</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">Boy</span><span class="params">(QObject *parent = <span class="literal">nullptr</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">signals:</span><br><span class="line">    <span class="comment">// 自定义信号写在类的signals下</span></span><br><span class="line">    <span class="comment">// 信号函数只需声明，无需实现</span></span><br><span class="line">    <span class="comment">// 信号函数返回值必须为void</span></span><br><span class="line">    <span class="comment">// 信号函数可以有参数，可以重载</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">love</span><span class="params">()</span></span>;<span class="comment">//自定义信号</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// BOY_H</span></span></span><br></pre></td></tr></table></figure></li><li><p>在Girl类的头文件和源文件中添加自定义槽函数的定义和实现</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//girl.h</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> GIRL_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GIRL_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QObject&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Girl</span> : <span class="keyword">public</span> QObject</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">Girl</span><span class="params">(QObject *parent = <span class="literal">nullptr</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">signals:</span><br><span class="line">    <span class="comment">//槽函数不能写在signals下，</span></span><br><span class="line">    <span class="comment">//必须写在public slots:下，新版本的Qt可以直接写在public或者全局下</span></span><br><span class="line"><span class="keyword">public</span> slots:</span><br><span class="line">    <span class="comment">//自定义槽函数</span></span><br><span class="line">    <span class="comment">//槽函数需要定义，也需要实现</span></span><br><span class="line">    <span class="comment">//槽函数也为void类型</span></span><br><span class="line">    <span class="comment">//槽函数也可以有参数，也可以重载</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">ask_love</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// GIRL_H</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//girl.cpp【右键ask_love函数名，Refactor重构，在girl.cpp中定义】</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;girl.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QDebug&gt;</span></span></span><br><span class="line"></span><br><span class="line">Girl::<span class="built_in">Girl</span>(QObject *parent)</span><br><span class="line">    : QObject&#123;parent&#125;</span><br><span class="line">&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Girl::ask_love</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;好呀好呀！&quot;</span>;<span class="comment">//需要头文件 &lt;QDebug&gt;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>Connect链接信号和槽函数，有两种方式。一种方式是直接在main函数中，创建Boy和Girl对象，并使用connect连接。【有警告】</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;boy.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;girl.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;mywidget.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QApplication&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">QApplication <span class="title">a</span><span class="params">(argc, argv)</span></span>;</span><br><span class="line">    MyWidget w;</span><br><span class="line"></span><br><span class="line">    <span class="function">Boy <span class="title">dsn</span><span class="params">(&amp;w)</span></span>;</span><br><span class="line">    <span class="function">Girl <span class="title">bfm</span><span class="params">(&amp;w)</span></span>;</span><br><span class="line">    w.<span class="built_in">connect</span>(&amp;dsn, &amp;Boy::love, &amp;bfm, &amp;Girl::ask_love);</span><br><span class="line"></span><br><span class="line">    w.<span class="built_in">show</span>();</span><br><span class="line">    dsn.<span class="built_in">love</span>();</span><br><span class="line">    <span class="comment">// emit dsn.love();</span></span><br><span class="line">    <span class="keyword">return</span> a.<span class="built_in">exec</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>方案二：在<code>mywidget.h</code>中的<code>mywidget</code>类中添加两个成员【两个对象指针】</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//mywidget.h</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> MYWIDGET_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MYWIDGET_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QWidget&gt;</span></span></span><br><span class="line"></span><br><span class="line">QT_BEGIN_NAMESPACE</span><br><span class="line"><span class="keyword">namespace</span> Ui &#123;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyWidget</span>;</span><br><span class="line">&#125;</span><br><span class="line">QT_END_NAMESPACE</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyWidget</span> : <span class="keyword">public</span> QWidget</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">MyWidget</span>(QWidget *parent = <span class="literal">nullptr</span>);</span><br><span class="line">    ~<span class="built_in">MyWidget</span>();</span><br><span class="line">    Boy *xgg;<span class="comment">//    ---------------一个boy对象xgg（小哥哥），girl对象xjj（小姐姐）</span></span><br><span class="line">       Girl *xjj;<span class="comment">//---------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Ui::MyWidget *ui;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// MYWIDGET_H</span></span></span><br><span class="line"><span class="comment">//#</span></span><br><span class="line"><span class="comment">//#</span></span><br><span class="line"><span class="comment">//#</span></span><br><span class="line"><span class="comment">//mywidget.cpp</span></span><br><span class="line"><span class="comment">//在mywidget.cpp中new出对象并添加连接</span></span><br><span class="line"><span class="comment">//【此处用到的emit为空的define，为了兼容旧版本】</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;mywidget.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ui_mywidget.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">MyWidget::<span class="built_in">MyWidget</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">QWidget</span>(parent)</span><br><span class="line">    , <span class="built_in">ui</span>(<span class="keyword">new</span> Ui::MyWidget)</span><br><span class="line">&#123;</span><br><span class="line">    ui-&gt;<span class="built_in">setupUi</span>(<span class="keyword">this</span>);</span><br><span class="line">    xgg= <span class="keyword">new</span> <span class="built_in">Boy</span>(<span class="keyword">this</span>);</span><br><span class="line">    xjj = <span class="keyword">new</span> <span class="built_in">Girl</span>(<span class="keyword">this</span>);<span class="comment">//new对象</span></span><br><span class="line">    <span class="comment">//建立连接，将小哥哥和小姐姐联系起来</span></span><br><span class="line">    <span class="built_in">connect</span>(xgg,&amp;Boy::love,xjj,&amp;Girl::lovetoo);</span><br><span class="line">    <span class="comment">//表白函数</span></span><br><span class="line">    <span class="built_in">valentines</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MyWidget::~<span class="built_in">Mywidget</span>()&#123;</span><br><span class="line">    <span class="keyword">delete</span> ui;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Mywidget::valentines</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//在表白中发送示爱信息</span></span><br><span class="line">    emit xgg-&gt;<span class="built_in">love</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>运行程序，程序在表白函数中发送示爱信息，接收者收到信息并执行相应的槽函数【运行结果：打印出了槽函数中的信息】</p></li></ol><p><strong>总结：</strong>自定义信号和槽的异同</p><ul><li>信号和槽都为void类型</li><li>信号只需要定义，不需要实现；而槽函数既需要定义，也需要实现</li><li>信号和槽都可以有参数，也都可以重载</li><li>emit是出发信号的标志，可要可不要。</li></ul><br><h4 id="2-5-2-自定义信号带参数重载问题"><a href="#2-5-2-自定义信号带参数重载问题" class="headerlink" title="2.5.2 自定义信号带参数重载问题"></a>2.5.2 自定义信号带参数重载问题</h4><blockquote><p>上节中提到，信号和槽都是可以带参数重载的。这一节来讨论带参数重载后的问题及解决的办法。</p></blockquote><blockquote><p>注意区分：重载|重写|重构</p><ul><li>重载：同名函数的重载，注意函数重载不关注返回值【编译时所有函数都存在】。</li><li>重构：继承父类的虚函数，子类重构父类虚函数【只有一个生效】。</li><li>重写：继承父类的非虚函数，子类重新写了该同名函数【完全修改，顶替父类函数】。</li></ul></blockquote><p>首先看需求：高富帅表白成功后，他们就很有默契了。他们就要约会，男的想说我们去看电影吧，女孩就很听男的话，收到信号后，就同意男孩，我们就去看电影。也就是说，男孩说什么，女孩就同意男孩也说什么，这之间的话，就通过信号的参数来传递。</p><ol><li><p>在<code>boy.h</code>的<code>signals</code>下重载<code>love</code>函数，带一个<code>QString</code>参数【即传递一个字符串消息，女孩也说这句话】</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//boy.h</span></span><br><span class="line"><span class="comment">//...</span></span><br><span class="line">signals:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">love</span><span class="params">()</span></span>;<span class="comment">//自定义信号</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">love</span><span class="params">(QString str)</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//注意：这个信号只需要定义，不需要实现</span></span><br><span class="line"><span class="comment">//想要触发这个信号，还需要一个QString的参数</span></span><br></pre></td></tr></table></figure></li><li><p>在<code>girl.cpp</code>也重载一个带参数的回应的槽函数</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//girl.h</span></span><br><span class="line"><span class="comment">//...</span></span><br><span class="line"><span class="keyword">public</span> slots:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">ask_love</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">ask_love</span><span class="params">(QString str)</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//girl.cpp</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;girl.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QDebug&gt;</span></span></span><br><span class="line"></span><br><span class="line">Girl::<span class="built_in">Girl</span>(QObject *parent)</span><br><span class="line">    : QObject&#123;parent&#125;</span><br><span class="line">&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Girl::ask_love</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;好呀好呀！&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Girl::ask_love</span><span class="params">(QString str)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;高富帅：&quot;</span>&lt;&lt; str &lt;&lt;<span class="string">&quot; | 白富美：好呀好呀！&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>回到 main.cpp 中会发现原来写好的没问题的connect函数报错；编译后发现错误：上下文不允许消除重载函数的歧义【重载函数歧义】</p><blockquote><p>信号和槽的连接函数中，就是一个函数名，也就是函数地址。</p><p>我们在重载之后，就有了两个<code>love</code>信号，也有了两个<code>love_ask</code>槽。那么这个函数指针，到底指的是哪一个呢？</p><p>这就让编译器为难了，你写了两个，我也不知道你到底要联系哪一个啊，就好比女孩是一对姐妹，而且名字也相同，你直接在楼下喊，安红我想你，你这让谁出来接受吧</p></blockquote></li><li><p>可以使用<span style="background:#bfff00">带参数的函数指针</span>来指向我们所要指向的那个函数【即<span style="background:#ff0">信号和槽必须一对一存在于connect</span>】。</p><blockquote><p>就好比，你表白的说，”我喜欢的是那个头发长长的，今天穿白色裙子的那个xxx“，这样就可以消除歧义。</p><p>【注意函数指针的写法！】</p></blockquote><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//参考示例：</span></span><br><span class="line"><span class="comment">//connect(xgg, &amp;Boy::love, xjj, &amp;Girl::lovetoo);</span></span><br><span class="line"><span class="comment">//定义一个带参数的函数指针，指向这个重载的函数</span></span><br><span class="line"><span class="built_in">void</span> (Boy::*strlove)(Qstring) = &amp;Boy::love;</span><br><span class="line"><span class="built_in">void</span> (Girl::*strlovetoo)(Qstring)= &amp;Girl::lovetoo:</span><br><span class="line"><span class="comment">//连接两个带参数的信号和槽</span></span><br><span class="line"><span class="built_in">connect</span>(xgg,strlove,xjj,strlovetoo);</span><br><span class="line"><span class="comment">//表白函数</span></span><br><span class="line"><span class="built_in">valentines</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//或者直接填入【强制转换】【不推荐，可读性差】</span></span><br><span class="line">w.<span class="built_in">connect</span>(&amp;dsn,</span><br><span class="line">          (<span class="built_in">void</span>(Boy::*)(QString)) &amp;Boy::love,</span><br><span class="line">          &amp;bfm,</span><br><span class="line">          (<span class="built_in">void</span>(Girl::*)(QString)) &amp;Girl::ack_love</span><br><span class="line">         );</span><br><span class="line"></span><br><span class="line"><span class="comment">// 练习-------------------------------------------------</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;boy.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;girl.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;mywidget.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QApplication&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">QApplication <span class="title">a</span><span class="params">(argc, argv)</span></span>;</span><br><span class="line">    MyWidget w;</span><br><span class="line"></span><br><span class="line">    <span class="function">Boy <span class="title">dsn</span><span class="params">(&amp;w)</span></span>;</span><br><span class="line">    <span class="function">Girl <span class="title">bfm</span><span class="params">(&amp;w)</span></span>;</span><br><span class="line">    <span class="comment">// w.connect(&amp;dsn, &amp;Boy::love, &amp;bfm, &amp;Girl::ask_love);//报错</span></span><br><span class="line">    <span class="built_in">void</span>(Boy::*pLove)(QString) = &amp;Boy::love;</span><br><span class="line">    <span class="built_in">void</span>(Girl::*pAskLove)(QString) = &amp;Girl::ask_love;</span><br><span class="line">    w.<span class="built_in">connect</span>(&amp;dsn, pLove, &amp;bfm, pAskLove);</span><br><span class="line">    w.<span class="built_in">connect</span>(&amp;dsn, (<span class="built_in">void</span>(Boy::*)())&amp;Boy::love, &amp;bfm, (<span class="built_in">void</span>(Girl::*)())&amp;Girl::ask_love);<span class="comment">//不带参数</span></span><br><span class="line"></span><br><span class="line">    w.<span class="built_in">show</span>();</span><br><span class="line">    emit dsn.<span class="built_in">love</span>();    <span class="comment">//好呀好呀！</span></span><br><span class="line">    emit dsn.<span class="built_in">love</span>(<span class="string">&quot;看电影&quot;</span>);<span class="comment">//高富帅： &quot;看电影&quot;  | 白富美：好呀好呀！</span></span><br><span class="line">    <span class="keyword">return</span> a.<span class="built_in">exec</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><br><h3 id="2-7-信号和槽的扩展"><a href="#2-7-信号和槽的扩展" class="headerlink" title="2.7 信号和槽的扩展"></a>2.7 信号和槽的扩展</h3><h4 id="2-7-1-信号连接信号"><a href="#2-7-1-信号连接信号" class="headerlink" title="2.7.1 信号连接信号"></a>2.7.1 信号连接信号</h4><blockquote><p>上一节中创建信号和槽函数，并建立二者的关联；这一节通过按钮的动作来触发信号【同样由connect完成】，再由信号触发槽函数。</p></blockquote><p>设计一个需求：按下一个按钮，再开始表白【理解：用代码实现按钮的信号连接】</p><ol><li>首先我们创建一个按钮，并加入窗体的children中，移动到中间一点的位置，设置文字为表白。</li><li>信号连接信号【connect】【注意：只要有重载，就必须明确指明使用哪一个槽函数或信号】</li></ol><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;boy.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;girl.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;mywidget.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QApplication&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QPushButton&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">QApplication <span class="title">a</span><span class="params">(argc, argv)</span></span>;</span><br><span class="line">    MyWidget w;</span><br><span class="line"></span><br><span class="line">    <span class="function">Boy <span class="title">dsn</span><span class="params">(&amp;w)</span></span>;</span><br><span class="line">    <span class="function">Girl <span class="title">bfm</span><span class="params">(&amp;w)</span></span>;</span><br><span class="line">    <span class="comment">// w.connect(&amp;dsn, &amp;Boy::love, &amp;bfm, &amp;Girl::ask_love);//报错</span></span><br><span class="line">    <span class="comment">//void(Boy::*pLove)(QString) = &amp;Boy::love;</span></span><br><span class="line">    <span class="comment">//void(Girl::*pAskLove)(QString) = &amp;Girl::ask_love;</span></span><br><span class="line">    <span class="comment">//w.connect(&amp;dsn, pLove, &amp;bfm, pAskLove);</span></span><br><span class="line">    w.<span class="built_in">connect</span>(&amp;dsn, (<span class="built_in">void</span>(Boy::*)())&amp;Boy::love, &amp;bfm, (<span class="built_in">void</span>(Girl::*)())&amp;Girl::ask_love);<span class="comment">//不带参数</span></span><br><span class="line"></span><br><span class="line">    QPushButton btn;</span><br><span class="line">    btn.<span class="built_in">setParent</span>(&amp;w);</span><br><span class="line">    btn.<span class="built_in">setText</span>(<span class="string">&quot;表白&quot;</span>);</span><br><span class="line">    <span class="comment">//报错，因为Boy::love有重载</span></span><br><span class="line">    <span class="comment">// w.connect(&amp;btn, &amp;QPushButton::clicked, &amp;dsn, &amp;Boy::love);</span></span><br><span class="line">    w.<span class="built_in">connect</span>(&amp;btn, &amp;QPushButton::clicked, &amp;dsn, (<span class="built_in">void</span>(Boy::*)())&amp;Boy::love);</span><br><span class="line"></span><br><span class="line">    w.<span class="built_in">show</span>();</span><br><span class="line">    <span class="keyword">return</span> a.<span class="built_in">exec</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个例子说明，Qt中使用Connect建立信号和槽函数之间的关系，是一个多对多的关系，且有两种形式：</p><ul><li>由一个信号是连接另一个信号，即由一个信号触发另一个信号【如上例中的按钮点击信号，触发了自定义信号】</li><li>由信号连接一个槽函数，即由一个信号触发一个动作【如上例中的自定义信号，触发自定义槽函数】</li></ul><p><img src="/.io//2-8.png"></p><p>另外，上面的写法存在一定的问题。如果在 <code>mywidget.cpp</code> 中创建Boy和Girl对象，那么该创建的对象会随着<code>MyWidget</code>对象的析构而析构【导致出现】。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;mywidget.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ui_mywidget.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QPushButton&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;boy.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;girl.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">MyWidget::<span class="built_in">MyWidget</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">QWidget</span>(parent)</span><br><span class="line">    , <span class="built_in">ui</span>(<span class="keyword">new</span> Ui::MyWidget)</span><br><span class="line">&#123;</span><br><span class="line">    ui-&gt;<span class="built_in">setupUi</span>(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//btn为Widget类的私有变量</span></span><br><span class="line">    btn =<span class="keyword">new</span> QPushButton;</span><br><span class="line">    btn-&gt;<span class="built_in">setParent</span>(<span class="keyword">this</span>);<span class="comment">//this即Widget对话框</span></span><br><span class="line">    btn-&gt;<span class="built_in">setText</span>(<span class="string">&quot;LOL&quot;</span>);</span><br><span class="line">    btn-&gt;<span class="built_in">resize</span>(<span class="number">160</span>,<span class="number">30</span>);<span class="comment">//设置按钮的大小为宽80，高30</span></span><br><span class="line">    btn-&gt;<span class="built_in">move</span>(<span class="number">80</span>,<span class="number">50</span>);<span class="comment">//以左上角为原点，右为x正方向移动80个像素，下为y正方向移动50个像素</span></span><br><span class="line">    btn-&gt;<span class="built_in">show</span>();</span><br><span class="line"></span><br><span class="line">    <span class="function">Boy <span class="title">dsn</span><span class="params">(<span class="keyword">this</span>)</span></span>;</span><br><span class="line">    <span class="function">Girl <span class="title">bfm</span><span class="params">(<span class="keyword">this</span>)</span></span>;</span><br><span class="line">    <span class="built_in">void</span>(Boy::*pLove)() = &amp;Boy::love;</span><br><span class="line">    <span class="built_in">void</span>(Girl::*pAskLove)() = &amp;Girl::ask_love;</span><br><span class="line">    <span class="built_in">connect</span>(&amp;dsn, pLove, &amp;bfm, pAskLove);<span class="comment">//连接自定义信号和槽函数</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 此处没有效果，因为Boy|Girl对象被析构</span></span><br><span class="line">    <span class="built_in">connect</span>(btn, &amp;QPushButton::clicked, &amp;dsn, (<span class="built_in">void</span>(Boy::*)())&amp;Boy::love);<span class="comment">//连接信号和自定义信号</span></span><br><span class="line">    <span class="built_in">connect</span>(btn, &amp;QPushButton::clicked, <span class="keyword">this</span>, &amp;MyWidget::close);<span class="comment">//连接信号和槽函数</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MyWidget::~<span class="built_in">MyWidget</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">delete</span> ui;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>故正确写法应该是：在<code>MyWidget</code>类中新建私有成员变量【<code>Boy dsn; Boy bfm;</code>】，这样就不会在<code>MyWidget</code>类析构时自动析构局部变量了。【注意类私有变量，在类实现中的写法】</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//mywidget.h[部分]</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyWidget</span> : <span class="keyword">public</span> QWidget</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">MyWidget</span>(QWidget *parent = <span class="literal">nullptr</span>);</span><br><span class="line">    ~<span class="built_in">MyWidget</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Ui::MyWidget *ui;</span><br><span class="line">    QPushButton *btn;</span><br><span class="line">    Boy dsn;</span><br><span class="line">    Girl bfm;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//#</span></span><br><span class="line"><span class="comment">//#</span></span><br><span class="line"><span class="comment">//mywidget.cpp</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;mywidget.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ui_mywidget.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QPushButton&gt;</span></span></span><br><span class="line"></span><br><span class="line">MyWidget::<span class="built_in">MyWidget</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">QWidget</span>(parent)</span><br><span class="line">    , <span class="built_in">ui</span>(<span class="keyword">new</span> Ui::MyWidget)</span><br><span class="line">    , <span class="built_in">dsn</span>(<span class="keyword">this</span>)</span><br><span class="line">    , <span class="built_in">bfm</span>(<span class="keyword">this</span>)</span><br><span class="line">&#123;</span><br><span class="line">    ui-&gt;<span class="built_in">setupUi</span>(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//btn为Widget类的私有变量</span></span><br><span class="line">    btn =<span class="keyword">new</span> QPushButton;</span><br><span class="line">    btn-&gt;<span class="built_in">setParent</span>(<span class="keyword">this</span>);<span class="comment">//this即Widget对话框</span></span><br><span class="line">    btn-&gt;<span class="built_in">setText</span>(<span class="string">&quot;LOL&quot;</span>);</span><br><span class="line">    btn-&gt;<span class="built_in">resize</span>(<span class="number">160</span>,<span class="number">30</span>);<span class="comment">//设置按钮的大小为宽80，高30</span></span><br><span class="line">    btn-&gt;<span class="built_in">move</span>(<span class="number">80</span>,<span class="number">50</span>);<span class="comment">//以左上角为原点，右为x正方向移动80个像素，下为y正方向移动50个像素</span></span><br><span class="line">    btn-&gt;<span class="built_in">show</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Boy dsn(this);</span></span><br><span class="line">    <span class="comment">// Girl bfm(this);</span></span><br><span class="line">    <span class="built_in">void</span>(Boy::*pLove)() = &amp;Boy::love;</span><br><span class="line">    <span class="built_in">void</span>(Girl::*pAskLove)() = &amp;Girl::ask_love;</span><br><span class="line">    <span class="built_in">connect</span>(&amp;dsn, pLove, &amp;bfm, pAskLove);<span class="comment">//连接自定义信号和槽函数</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">connect</span>(btn, &amp;QPushButton::clicked, &amp;dsn, pLove);<span class="comment">//连接信号和自定义信号</span></span><br><span class="line">    <span class="built_in">connect</span>(btn, &amp;QPushButton::clicked, <span class="keyword">this</span>, &amp;MyWidget::close);<span class="comment">//连接信号和槽函数</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MyWidget::~<span class="built_in">MyWidget</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">delete</span> ui;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><h4 id="2-7-2-信号的断开"><a href="#2-7-2-信号的断开" class="headerlink" title="2.7.2 信号的断开"></a>2.7.2 信号的断开</h4><p>建立信号连接之后，在某些场景下，需要中断信号连接。</p><p>通过<code>disconnect</code>函数来断开连接：<code>disconnect</code>(信号发送者，信号，接收者，槽函数)；</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1 完全指定断开：如果你知道连接的确切细节，你可以指定发送者、信号、接收者和槽函数。</span></span><br><span class="line"><span class="built_in">disconnect</span>(sender, signal, receiver, slot);</span><br><span class="line"></span><br><span class="line"><span class="comment">//2 部分指定断开：</span></span><br><span class="line"><span class="comment">//如果你只想断开特定发送者的所有信号与某个接收者的连接，</span></span><br><span class="line"><span class="comment">//或者断开某个接收者的所有槽函数对特定信号的监听，可以使用nullptr或0作为占位符。</span></span><br><span class="line"><span class="comment">//示例：断开sender的所有信号与receiver的所有槽的连接</span></span><br><span class="line"><span class="built_in">disconnect</span>(sender, <span class="literal">nullptr</span>, receiver, <span class="literal">nullptr</span>);</span><br><span class="line"><span class="comment">//示例：断开所有发送者发出的signal信号与receiver的连接</span></span><br><span class="line"><span class="built_in">disconnect</span>(<span class="literal">nullptr</span>, signal, receiver, <span class="literal">nullptr</span>);</span><br><span class="line"><span class="comment">//示例：断开sender的signal信号与receiver的所有槽的连接</span></span><br><span class="line"><span class="built_in">disconnect</span>(sender, signal, <span class="literal">nullptr</span>, <span class="literal">nullptr</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//使用lambda表达式或functor断开连接：</span></span><br><span class="line"><span class="comment">//如果你之前使用了lambda表达式或函数对象作为槽函数，你需要使用 DisconnectMatcher 或其他机制来断开连接，因为不能直接提供槽函数的签名。</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">//3 断开所有连接：如果你想断开一个对象的所有信号与槽的连接，可以这样做：</span></span><br><span class="line"><span class="built_in">disconnect</span>(myObject, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>); <span class="comment">// Qt5之前的版本</span></span><br><span class="line"><span class="built_in">disconnect</span>(myObject); <span class="comment">// Qt5及以后的版本，更简洁的方式</span></span><br></pre></td></tr></table></figure><br><h4 id="2-7-3-小结"><a href="#2-7-3-小结" class="headerlink" title="2.7.3 小结"></a>2.7.3 小结</h4><p>需要注意的是：</p><ul><li>一个信号可以连接多个槽函数：如在按下按钮的时候，不仅表白，还要关闭窗口【只需要将btn的单击信号再连接一个close的槽函数即可】。</li><li>多个信号可以连接同一个槽函数：如按钮和窗口上的x都可以关闭窗口。</li><li>信号和槽的参数必须一一对应：信号的发送什么，槽就接收什么，类型必须一致【但信号的参数个数可以多于槽的参数的个数，但前面相同数量的参数类型必须一一对应；反之则不可以】。</li></ul><br><h3 id="2-8-Lambda函数"><a href="#2-8-Lambda函数" class="headerlink" title="2.8 Lambda函数"></a>2.8 Lambda函数</h3><h4 id="2-8-1-基本认识"><a href="#2-8-1-基本认识" class="headerlink" title="2.8.1 基本认识"></a>2.8.1 基本认识</h4><p><code>Lambda</code>函数，也叫<code>Lambda</code>表达式，即匿名函数【没有名字的函数】。<code>Lambda</code>表达式是<code>C++11</code>中引入的新概念，用于定义并创建匿名的函数对象。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Lambda表达式的基本结构</span></span><br><span class="line"><span class="comment">//[捕捉列表] (参数) mutable -&gt; 返回值类型 &#123;函数体&#125;</span></span><br><span class="line">[]()&#123;</span><br><span class="line">    <span class="built_in">qDebug</span>(<span class="string">&quot;Lambda&quot;</span>);</span><br><span class="line">&#125;();</span><br></pre></td></tr></table></figure><blockquote><p>为什么使用Lambda函数？</p><p>有些函数如果只是临时一用，而且它的业务逻辑也很简单时，就没必要非给它取个名字不可。在Qt中甚至可以简化一些操作【在实例会有讲到】。</p><p>例如：由于自定义信号只需要定义，而不需要实现，且很多自定义槽函数也只是简单定义和简单实现，故无需要花太多精力来创建类并添加信号和槽函数，Lambda函数应运而生。</p></blockquote><ul><li><p><code>[]</code>：标识一个<code>Lambda</code>匿名函数的开始【必需，且不能省略】【实际上，<code>[]</code>是Lambda引出符，编译器根据该引出符判断接下来的代码是否是Lambda函数】。其中填写的捕捉列表，即传入函数的环境参数【函数对象参数】，如<code>this</code>。</p><blockquote><p>函数对象参数，是传递给编译器并自动生成的函数对象类的构造函数的成员。</p><p>函数对象参数只能使用到<code>Lambda</code>定义为止、<code>Lambda</code>所在的作用域范围内可见的局部变量，包括<code>Lambda</code>所在类的<code>this</code>。</p></blockquote></li><li><p>函数对象参数【捕捉列表】有以下形式：</p><ul><li>空：无法访问任何外部变量</li><li><code>=</code>：函数体内使用<code>Lambda</code>所在范围内的可见局部变量，包括所在类的<code>this</code>的传值方式【相当于编译器给Lambda所在地的所有局部变量 **复制 **一份给Lambda函数】。</li><li><code>&amp;</code>：函数体内使用<code>Lambda</code>所在范围内的可见局部变量，包括所在类的<code>this</code>的引用方式【相当于编译器给Lambda所在地的所有局部变量的<strong>引用</strong>，交给Lambda函数】。</li><li><code>this</code>：函数体内可以访问<code>Lambda</code>所在类的成员变量。</li><li><code>axxxx</code>：本地的某个具体变量，可以在Lambda内拷贝使用。</li><li><code>&amp;axxx</code>：Lambda内引用本地变量。</li><li><code>a,&amp;b</code>：拷贝a，引用b。</li><li><code>=, &amp;a, &amp;b</code>：除ab引用，其余拷贝。</li><li><code>&amp;，a，b</code>：除ab拷贝，其余引用。</li></ul></li><li><p>函数参数：同常规函数。</p></li><li><p><code>mutatble</code>：修改关键字【显式 | 隐式】。</p><ul><li>显式使用<code>mutatble</code>关键字，才能修改函数对象参数，否则不可修改，即报错。</li><li>省略<code>mutable</code>：lambda默认为const，即不能修改本地变量。</li></ul></li><li><p><code>-&gt;</code>：<code>return-type</code>返回值的方式。</p></li><li><p>函数体：同常规函数。</p></li></ul><h4 id="2-8-2-Lambda函数的基本使用"><a href="#2-8-2-Lambda函数的基本使用" class="headerlink" title="2.8.2 Lambda函数的基本使用"></a>2.8.2 Lambda函数的基本使用</h4><p><code>Lambda</code>是<code>C++11</code>版本中才有功能，故须要确保Qt支持C++11。配置方法如下：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 打开项目的pro文件</span></span><br><span class="line"><span class="comment">//在CONFIG中添加:</span></span><br><span class="line">CONFIG += c+<span class="number">+11</span></span><br></pre></td></tr></table></figure><blockquote><p>一般的来说，<code>Qt5.4</code>版本以上的项目，已经会自动给添加CONFIG += c++11；但5.4以前的版本，可能就需要看看是否支持<code>CONFIG += c++11</code>，而且还需要手动在pro文件中添加<code>CONFIG += c++11</code>。</p></blockquote><p><strong>Lambda举例：</strong>新建两个按钮，在两个connect函数中直接写Lambda函数体。消息触发时，直接调用槽函数【Lambda函数】</p><blockquote><p>注意：值传递时，有关键字<code>mutable</code>可以在函数中修改a的值，但不会影响外面的值。</p></blockquote><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;widget.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ui_widget.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QPushButton&gt;</span></span></span><br><span class="line"></span><br><span class="line">Widget::<span class="built_in">Widget</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">QWidget</span>(parent)</span><br><span class="line">    , <span class="built_in">ui</span>(<span class="keyword">new</span> Ui::Widget)</span><br><span class="line">&#123;</span><br><span class="line">    ui-&gt;<span class="built_in">setupUi</span>(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    QPushButton *btn1, *btn2;</span><br><span class="line">    btn1 = <span class="keyword">new</span> QPushButton;</span><br><span class="line">    btn2 = <span class="keyword">new</span> QPushButton;</span><br><span class="line">    btn1-&gt;<span class="built_in">setParent</span>(<span class="keyword">this</span>);<span class="comment">//绑定父类后，无需手动delete</span></span><br><span class="line">    btn2-&gt;<span class="built_in">setParent</span>(<span class="keyword">this</span>);</span><br><span class="line">    btn1-&gt;<span class="built_in">setText</span>(<span class="string">&quot;+100&quot;</span>);</span><br><span class="line">    btn2-&gt;<span class="built_in">setText</span>(<span class="string">&quot;show&quot;</span>);</span><br><span class="line">    btn1-&gt;<span class="built_in">move</span>(<span class="number">100</span>,<span class="number">100</span>);</span><br><span class="line">    btn2-&gt;<span class="built_in">move</span>(<span class="number">300</span>,<span class="number">100</span>);</span><br><span class="line">    <span class="type">int</span> a = <span class="number">10</span>;</span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; __LINE__ &lt;&lt; a;<span class="comment">//行号宏</span></span><br><span class="line">    <span class="comment">//connect(btn1, &amp;QPushButton::clicked, this, [&amp;a]()mutable-&gt;void&#123;a+=100; qDebug() &lt;&lt; a;&#125;);</span></span><br><span class="line">    <span class="comment">//connect(btn2, &amp;QPushButton::clicked, this, [&amp;a]()&#123;qDebug() &lt;&lt;__LINE__ &lt;&lt; a;&#125;);//可省略-&gt;void</span></span><br><span class="line">    <span class="comment">//注意此处的a是个局部变量，连该类的成员变量都不是</span></span><br><span class="line">    <span class="comment">//当该默认构造函数执行完毕，局部变量a就被释放，故信号和槽函数访问的a一直都是被释放过的区域</span></span><br><span class="line">    <span class="comment">//故a最好是全局变量或该类的成员变量【以下b为成员变量】</span></span><br><span class="line">    b = <span class="number">10</span>;</span><br><span class="line">    <span class="built_in">connect</span>(btn1, &amp;QPushButton::clicked, <span class="keyword">this</span>, [<span class="keyword">this</span>]()<span class="keyword">mutable</span>-&gt;<span class="type">void</span>&#123;b+=<span class="number">100</span>; <span class="built_in">qDebug</span>() &lt;&lt; b;&#125;);</span><br><span class="line">    <span class="built_in">connect</span>(btn2, &amp;QPushButton::clicked, <span class="keyword">this</span>, [<span class="keyword">this</span>]()&#123;<span class="built_in">qDebug</span>() &lt;&lt;__LINE__ &lt;&lt; b;&#125;);<span class="comment">//可省略-&gt;void</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Widget::~<span class="built_in">Widget</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">delete</span> ui;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><h4 id="2-8-3-Lambda函数扩展"><a href="#2-8-3-Lambda函数扩展" class="headerlink" title="2.8.3 Lambda函数扩展"></a>2.8.3 Lambda函数扩展</h4><h5 id="1-Lambda的返回值"><a href="#1-Lambda的返回值" class="headerlink" title="1 Lambda的返回值"></a>1 Lambda的返回值</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序能正确输出函数返回的结果8,ret=8</span></span><br><span class="line"><span class="type">int</span> ret = []()-&gt;<span class="type">int</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">8</span>;</span><br><span class="line">&#125;();</span><br><span class="line"></span><br><span class="line">ret = [&amp;ret]()<span class="keyword">mutable</span>-&gt;<span class="type">int</span>&#123;</span><br><span class="line">    ret *= <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;();</span><br><span class="line"></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; ret;<span class="comment">//16</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//斐波那契 0 1 1 2 3 5 8 13 ...</span></span><br><span class="line"><span class="type">int</span> aa=<span class="number">0</span>, bb=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">10</span>; i++)</span><br><span class="line">        [](<span class="type">int</span> &amp;aa, <span class="type">int</span> &amp;bb) -&gt; <span class="type">int</span>&#123;</span><br><span class="line">            <span class="type">int</span> rett = aa + bb;</span><br><span class="line">            aa = bb;</span><br><span class="line">            bb = rett;</span><br><span class="line">            <span class="built_in">qDebug</span>() &lt;&lt; rett;</span><br><span class="line">            <span class="keyword">return</span> rett;</span><br><span class="line">        &#125;(aa, bb);</span><br><span class="line"></span><br><span class="line"><span class="comment">//优化</span></span><br><span class="line"><span class="type">int</span> aaa=<span class="number">0</span>, bbb=<span class="number">1</span>;</span><br><span class="line">[](<span class="type">int</span> &amp;aa, <span class="type">int</span> &amp;bb, <span class="type">int</span> count)&#123;</span><br><span class="line">    <span class="type">int</span> rett = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;count; i++)&#123;</span><br><span class="line">        <span class="type">int</span> rett = aa + bb;</span><br><span class="line">        aa = bb;</span><br><span class="line">        bb = rett;</span><br><span class="line">        <span class="built_in">qDebug</span>() &lt;&lt; rett;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;(aaa, bbb, <span class="number">10</span>);</span><br></pre></td></tr></table></figure><p>注意：</p><ul><li><code>-&gt;</code>是有返回值的标志，<code>int</code>是返回值的类型，在函数中直接返回</li><li>最后的 <code>()</code> 是调用函数；没有 <code>()</code> 时，仅是函数定义，而不是函数的调用。</li></ul><br><h5 id="2-Lambda的应用"><a href="#2-Lambda的应用" class="headerlink" title="2 Lambda的应用"></a>2 Lambda的应用</h5><p>🔺使用无参按钮，调用有参的槽函数</p><blockquote><p>之前提到，如果用具体定义的有名函数，必需要有对应参数，或信号函数的参数多于槽函数参数</p><p>但此处实际上是无参的信号，触发了一个匿名函数，该匿名函数再提供参数并触发了一个有参槽函数。</p></blockquote><p>按钮的单击是没有参数的，匿名函数也没有参数，只是在匿名函数中调用了一个有参的信号。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//boy girl的 案例中</span></span><br><span class="line"><span class="built_in">connect</span>(btn, &amp;QPushButton::clicked, &amp;dsn, [=]()&#123;dsn.<span class="built_in">love</span>(<span class="string">&quot;一起看电影吧！&quot;</span>);&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">void</span>(Boy::*pLoveP)(QString) = &amp;Boy::love;</span><br><span class="line"><span class="built_in">void</span>(Girl::*pAskLoveP)(QString) = &amp;Girl::ask_love;</span><br><span class="line"><span class="built_in">connect</span>(&amp;dsn, pLoveP, &amp;bfm, pAskLoveP);<span class="comment">//带参</span></span><br><span class="line"><span class="comment">//输出</span></span><br><span class="line"><span class="comment">//高富帅： &quot;一起看电影吧！&quot;  | 白富美：好呀好呀！</span></span><br></pre></td></tr></table></figure><p>另外，我们在输出中发现，<code>Lambda</code> 函数中提供的参数是双引号括起来的字符串，为什么输出的时候，依然带着双引号呢？</p><blockquote><p>虽然写入的是一个字符串，但在Qt中会自动转换为 <code>QString</code>，它会自动添加双引号【而我们习惯上使用 <code>char*</code>，其输出没有双引号】。</p><p>如何修改见下一小结。</p></blockquote><br><h5 id="3-QString转char"><a href="#3-QString转char" class="headerlink" title="3 QString转char*"></a>3 <code>QString</code>转<code>char*</code></h5><blockquote><p>QString的帮助文档中，详细列举了其各类方法。</p></blockquote><p>其中的<code>toUtf8</code>的方法，返回的是一个QByteArray，先转成一个Q字节数组，再转成<code>char*</code></p><blockquote><p>再通过帮助文档找QByteArray，继续看它的公共的方法。看里面找找，有没有返回值就是char*的方法。</p></blockquote><p><img src="/.io//2-9.png"></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;我也喜欢你！&quot;</span>&lt;&lt;str.<span class="built_in">toUtf8</span>().<span class="built_in">data</span>();</span><br><span class="line"><span class="comment">//输出中str无双引号</span></span><br></pre></td></tr></table></figure><br><h5 id="4-Lambda使代码简洁高效"><a href="#4-Lambda使代码简洁高效" class="headerlink" title="4 Lambda使代码简洁高效"></a>4 Lambda使代码简洁高效</h5><p>比如我们之前学习的单击按钮关闭窗口对不对。那么现在我们学习了Lambda后可以这么写。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">connect</span>(btn, &amp;QPushButton::clicked, <span class="keyword">this</span>, &amp;MyWidget::close);<span class="comment">//连接信号和槽函数</span></span><br><span class="line"><span class="comment">//等同于只写三个参数</span></span><br><span class="line"><span class="built_in">connect</span>(btn, &amp;QPushButton::clicked, <span class="keyword">this</span>, [=]()&#123;<span class="keyword">this</span>-&gt;<span class="built_in">cloes</span>();&#125;);</span><br><span class="line"><span class="comment">//信号的接收者是this的话，this也可以省略</span></span><br><span class="line"><span class="built_in">connect</span>(btn, &amp;QPushButton::clicked, [=]()&#123;<span class="keyword">this</span>-&gt;<span class="built_in">cloes</span>();&#125;);</span><br></pre></td></tr></table></figure><br><h4 id="2-8-4-Lambda函数QA"><a href="#2-8-4-Lambda函数QA" class="headerlink" title="2.8.4 Lambda函数QA"></a>2.8.4 Lambda函数QA</h4><p>🔺<code>C++</code> <code>lambda</code>表达式的本质就是重载了<code>operator()</code>，即仿函数。 <code>lambda</code>是一个类，在调用时会进行编译展开，因此<code>lambda</code>表达式对象其实就是一个匿名函数，<code>lambda</code>表达式也叫匿名函数对象。</p><blockquote><p>按照C++标准，lambda表达式的operator()默认是const的，一个const成员函数是无法修改成员变量值的。</p><p><strong>mutable 选项的作用就在于取消 operator () 的 const 属性。</strong></p></blockquote><blockquote><p>因为 <code>lambda</code> 表达式在 C++ 中会被看做是一个仿函数，因此可以使用<code>std::function</code>和<code>std::bind</code>来存储和操作lambda表达式：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;functional&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 包装可调用函数</span></span><br><span class="line">    std::function&lt;<span class="type">int</span>(<span class="type">int</span>)&gt; f1 = [](<span class="type">int</span> a) &#123;<span class="keyword">return</span> a; &#125;;</span><br><span class="line">    <span class="comment">// 绑定可调用函数</span></span><br><span class="line">    std::function&lt;<span class="type">int</span>(<span class="type">int</span>)&gt; f2 = <span class="built_in">bind</span>([](<span class="type">int</span> a) &#123;<span class="keyword">return</span> a; &#125;, placeholders::_1);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 函数调用</span></span><br><span class="line">    cout &lt;&lt; <span class="built_in">f1</span>(<span class="number">100</span>) &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="built_in">f2</span>(<span class="number">200</span>) &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//*</span></span><br><span class="line"><span class="comment">//*</span></span><br><span class="line"><span class="keyword">using</span> func_ptr = <span class="built_in">int</span>(*)(<span class="type">int</span>);</span><br><span class="line"><span class="comment">// 没有捕获任何外部变量的匿名函数</span></span><br><span class="line">func_ptr f = [](<span class="type">int</span> a)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> a;  </span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 函数调用</span></span><br><span class="line"><span class="built_in">f</span>(<span class="number">1314</span>);</span><br></pre></td></tr></table></figure><p>对于没有捕获任何变量的 lambda 表达式，还可以转换成一个普通的函数指针：如上代码块。</p></blockquote><p>🔺关于<code>[]</code>中填写的捕获对象：捕获外部变量，捕获的变量可以在函数体中使用。可以省略，即不捕获外部变量;一共有三种捕获方式：</p><ul><li>值捕获<code>=</code>：不能在lambda表达式中修改捕获变量的值</li><li>引用捕获<code>&amp;</code>：需在捕获列表变量前面加上引用说明符&amp;，可以在lamdba表达式中修改捕获变量的值</li><li>隐式捕获：在<code>[捕获列表]</code>中不写捕获的外部变量【<code>2.8.1</code>中介绍】，而是直接写<code>=/&amp;</code>来代表值捕获还是引用捕获</li></ul><br><h2 id="三-常用控件和类"><a href="#三-常用控件和类" class="headerlink" title="三 常用控件和类"></a>三 常用控件和类</h2><h3 id="3-1-QTextEdit控件"><a href="#3-1-QTextEdit控件" class="headerlink" title="3.1 QTextEdit控件"></a>3.1 QTextEdit控件</h3><h4 id="3-1-1-QTextEdit类及初步使用"><a href="#3-1-1-QTextEdit类及初步使用" class="headerlink" title="3.1.1 QTextEdit类及初步使用"></a>3.1.1 QTextEdit类及初步使用</h4><p><code>QTextEdit</code> 是一个文本编辑类。</p><p>当程序需要与用户进行数据交互，如用户输入数据，就需要此类控件【比如QQ程序的登录界面，其实就是多个文本编辑类，且内容不可见】。</p><p><strong>上手案例：</strong></p><ol><li><p>首先，新建一个<code>QMainWindow</code>项目，先运行一次，看能否正常看到窗口画面，测试下自己的环境是否正确。</p></li><li><p>查看<code>QTextEdit</code>的帮助文档，将头文件 <code>&lt;QTextEdit&gt;</code> 加入到 <code>mainwindow.h</code> 的头部。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Header:  <span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QTextEdit&gt;</span>--------------------------头文件</span></span><br><span class="line">CMake: <span class="built_in">find_package</span>(Qt6 REQUIRED COMPONENTS Widgets)</span><br><span class="line"><span class="built_in">target_link_libraries</span>(mytarget PRIVATE Qt6::Widgets)</span><br><span class="line">qmake: QT += widgets-----------------------------------添加widgets编译组件</span><br><span class="line">Inherits: QAbstractScrollArea--------------------------父类</span><br><span class="line">Inherited By: QTextBrowser-----------------------------子类</span><br><span class="line"></span><br><span class="line"><span class="comment">//常用函数</span></span><br><span class="line"><span class="comment">//功能：将Edit的内容转为无格式文本</span></span><br><span class="line">QString <span class="built_in">toPlainText</span>() <span class="type">const</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//功能：输入Edit【继承自父类】</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setText</span><span class="params">(Qstring)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//功能：设置背景颜色</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setTextBackgroundColor</span><span class="params">(<span class="type">const</span> QColor &amp;c)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//功能：设置文本颜色</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setTextColor</span><span class="params">(<span class="type">const</span> QColor &amp;c)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//功能：设置字体大小</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setFontPointSize</span><span class="params">(qreal s)</span></span>;</span><br></pre></td></tr></table></figure></li><li><p>在 <code>mainwindow.cpp</code> 中编写代码</p></li></ol><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;mainwindow.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ui_mainwindow.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QDebug&gt;</span></span></span><br><span class="line"></span><br><span class="line">MainWindow::<span class="built_in">MainWindow</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">QMainWindow</span>(parent)</span><br><span class="line">    , <span class="built_in">ui</span>(<span class="keyword">new</span> Ui::MainWindow)</span><br><span class="line">&#123;</span><br><span class="line">    ui-&gt;<span class="built_in">setupUi</span>(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    QTextEdit* edit = <span class="keyword">new</span> <span class="built_in">QTextEdit</span>(<span class="keyword">this</span>);</span><br><span class="line">    edit-&gt;<span class="built_in">resize</span>(<span class="number">200</span>,<span class="number">30</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//将edit的输入内容与button互动</span></span><br><span class="line">    QPushButton* btn = <span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;输出&quot;</span>, <span class="keyword">this</span>);</span><br><span class="line">    QPushButton* btnInput = <span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;输入&quot;</span>, <span class="keyword">this</span>);</span><br><span class="line">    <span class="comment">// btn-&gt;setText(&quot;输出&quot;);</span></span><br><span class="line">    btn-&gt;<span class="built_in">move</span>(<span class="number">0</span>, <span class="number">50</span>);</span><br><span class="line">    btnInput-&gt;<span class="built_in">move</span>(<span class="number">100</span>, <span class="number">50</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//点击按钮获取文本框内容并输出</span></span><br><span class="line">    <span class="built_in">connect</span>(btn, &amp;QPushButton::clicked, [=]()&#123;</span><br><span class="line">        <span class="built_in">qDebug</span>() &lt;&lt; edit-&gt;<span class="built_in">toPlainText</span>().<span class="built_in">toUtf8</span>().<span class="built_in">data</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">//点击按钮，向文本框输入内容</span></span><br><span class="line">    <span class="built_in">connect</span>(btnInput, &amp;QPushButton::clicked, [=]()&#123;</span><br><span class="line">        edit-&gt;<span class="built_in">setTextColor</span>(Qt::magenta);</span><br><span class="line">        edit-&gt;<span class="built_in">setTextBackgroundColor</span>(Qt::green);</span><br><span class="line">        edit-&gt;<span class="built_in">setFontPointSize</span>(<span class="number">20</span>);</span><br><span class="line">        edit-&gt;<span class="built_in">setText</span>(<span class="string">&quot;系统生成&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MainWindow::~<span class="built_in">MainWindow</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">delete</span> ui;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><h4 id="3-1-2-QTextEdit的信号"><a href="#3-1-2-QTextEdit的信号" class="headerlink" title="3.1.2 QTextEdit的信号"></a>3.1.2 QTextEdit的信号</h4><p>查看帮助文档，搜索<code>QTextEdit</code>类：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">copyAvailable</span><span class="params">(<span class="type">bool</span> yes)</span><span class="comment">//----------是否能够COPY</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">currentCharFormatChanged</span><span class="params">(<span class="type">const</span> QTextCharFormat &amp;f)</span><span class="comment">//当字符格式发生变化</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">cursorPositionChanged</span><span class="params">()</span><span class="comment">//----------当光标位置发生变化</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">redoAvailable</span><span class="params">(<span class="type">bool</span> available)</span><span class="comment">//----是否可重写</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">selectionChanged</span><span class="params">()</span><span class="comment">//---------------选择区域变化</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">textChanged</span><span class="params">()</span><span class="comment">//--------------------文本是否发生变化</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">undoAvailable</span><span class="params">(<span class="type">bool</span> available)</span><span class="comment">//----是否可撤销</span></span></span><br><span class="line"><span class="function">     </span></span><br><span class="line"><span class="function"><span class="comment">// 3个继承自Widget</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">customContextMenuRequested</span><span class="params">(<span class="type">const</span> QPoint &amp;pos)</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">windowIconChanged</span><span class="params">(<span class="type">const</span> QIcon &amp;icon)</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">windowTitleChanged</span><span class="params">(<span class="type">const</span> QString &amp;title)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// 2个继承自QObject</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">destroyed</span><span class="params">(QObject *obj = <span class="literal">nullptr</span>)</span><span class="comment">//-------------当类销毁时</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">objectNameChanged</span><span class="params">(<span class="type">const</span> QString &amp;objectName<span class="comment">//---当对象名称改变</span></span></span></span><br></pre></td></tr></table></figure><blockquote><p>下文中以 <code>textChanged</code> 信号为例完成案例</p></blockquote><p><strong>案例</strong>【需求：一个文本框种输入数据，另一个文本框中实时的更新第一个文本框中输入的内容】</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;mainwindow.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ui_mainwindow.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QDebug&gt;</span></span></span><br><span class="line"></span><br><span class="line">MainWindow::<span class="built_in">MainWindow</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">QMainWindow</span>(parent)</span><br><span class="line">    , <span class="built_in">ui</span>(<span class="keyword">new</span> Ui::MainWindow)</span><br><span class="line">&#123;</span><br><span class="line">    ui-&gt;<span class="built_in">setupUi</span>(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    QTextEdit* edit = <span class="keyword">new</span> <span class="built_in">QTextEdit</span>(<span class="keyword">this</span>);</span><br><span class="line">    QTextEdit* copy = <span class="keyword">new</span> <span class="built_in">QTextEdit</span>(<span class="keyword">this</span>);</span><br><span class="line">    edit-&gt;<span class="built_in">resize</span>(<span class="number">250</span>,<span class="number">30</span>);</span><br><span class="line">    copy-&gt;<span class="built_in">resize</span>(<span class="number">250</span>,<span class="number">30</span>);</span><br><span class="line">    copy-&gt;<span class="built_in">move</span>(<span class="number">300</span>,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">connect</span>(edit, &amp;QTextEdit::textChanged, [=]()&#123;</span><br><span class="line">        copy-&gt;<span class="built_in">setText</span>(edit-&gt;<span class="built_in">toPlainText</span>());<span class="comment">//返回和参数都是QString</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MainWindow::~<span class="built_in">MainWindow</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">delete</span> ui;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/.io//3-1.png"></p><br><h3 id="3-2-QMainWindow"><a href="#3-2-QMainWindow" class="headerlink" title="3.2 QMainWindow"></a>3.2 QMainWindow</h3><p><code>QMainWindow</code>是一个为用户提供主窗口的类，包含菜单栏【menubar】、多个工具栏【toolbar】、多个铆接部件【dockwidgets浮动窗口】，一个状态栏【status】及一个中心部件【centralwidget】，是许多应用程序的基础，如文本编辑器，图片编辑器等。下面以Photoshop为例：</p><p><img src="/.io//3-2.png"></p><blockquote><p>Photoshop占的比较全，基本上都有，但不是所有的软件都有着所有的部件。</p></blockquote><br><h4 id="3-2-1-菜单栏-MenuBar"><a href="#3-2-1-菜单栏-MenuBar" class="headerlink" title="3.2.1 菜单栏 MenuBar"></a>3.2.1 菜单栏 MenuBar</h4><p><strong>案例：菜单栏项目</strong>【需求：最上面的一行，大多数的软件都有，如Qt Create 也有，每个软件工具栏只能有一个】</p><ol><li><p>建立QMainWindow项目，类选项选择QMainWindows。【通过点击类名跳转查看，其实<code>QMainWindows</code>也是<code>QWidget</code>的派生类】</p></li><li><p>添加菜单栏：在Qt中，使用<code>QMenuBar *QMainWindow::menuBar() const</code>可以创建工菜单栏。</p></li><li><p>查找该函数<code>QMenuBar</code>的帮助文档【搜索menubar，选择QMainWindows下的类】，常用函数如下：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">Header:  <span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QMenuBar&gt;</span></span></span><br><span class="line">CMake: <span class="built_in">find_package</span>(Qt6 REQUIRED COMPONENTS Widgets) </span><br><span class="line"><span class="built_in">target_link_libraries</span>(mytarget PRIVATE Qt6::Widgets)</span><br><span class="line">qmake: QT += widgets</span><br><span class="line">Inherits: QWidget</span><br><span class="line">    </span><br><span class="line"><span class="comment">//QMainWindow类中</span></span><br><span class="line">QMenuBar *<span class="built_in">menuBar</span>() <span class="type">const</span>;<span class="comment">//-------------------创建菜单栏</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setMenuBar</span><span class="params">(QMenuBar *menuBar)</span></span>;<span class="comment">//----------将QMenuBar设置进窗口</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//QMenuBar类中</span></span><br><span class="line"><span class="built_in">QMenuBar</span>(QWidget *parent = <span class="literal">nullptr</span>);<span class="comment">//---------创建一个带父对象的menubar</span></span><br><span class="line"></span><br><span class="line"><span class="function">QAction *<span class="title">addMenu</span><span class="params">(QMenu *menu)</span></span>;<span class="comment">//添加子菜单</span></span><br><span class="line"><span class="function">QMenu *<span class="title">addMenu</span><span class="params">(<span class="type">const</span> QString &amp;title)</span></span>;</span><br><span class="line"><span class="function">QMenu *<span class="title">addMenu</span><span class="params">(<span class="type">const</span> QIcon &amp;icon, <span class="type">const</span> QString &amp;title)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function">QAction *<span class="title">addSeparator</span><span class="params">()</span></span>;<span class="comment">//添加分割线</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//QMenu类中</span></span><br><span class="line"><span class="function">QAction *<span class="title">addMenu</span><span class="params">(QMenu *menu)</span></span>;</span><br><span class="line"><span class="function">QMenu *<span class="title">addMenu</span><span class="params">(<span class="type">const</span> QString &amp;title)</span></span>;</span><br><span class="line"><span class="function">QMenu *<span class="title">addMenu</span><span class="params">(<span class="type">const</span> QIcon &amp;icon, <span class="type">const</span> QString &amp;title)</span></span>;</span><br><span class="line">    </span><br><span class="line"><span class="function">QAction *<span class="title">addSection</span><span class="params">(<span class="type">const</span> QString &amp;text)</span></span>;</span><br><span class="line"><span class="function">QAction *<span class="title">addSection</span><span class="params">(<span class="type">const</span> QIcon &amp;icon, <span class="type">const</span> QString &amp;text)</span></span>;</span><br><span class="line"><span class="function">QAction *<span class="title">addSeparator</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure></li><li><p>添加代码</p></li></ol><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;mainwindow.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ui_mainwindow.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QDebug&gt;</span></span></span><br><span class="line"></span><br><span class="line">MainWindow::<span class="built_in">MainWindow</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">QMainWindow</span>(parent)</span><br><span class="line">    , <span class="built_in">ui</span>(<span class="keyword">new</span> Ui::MainWindow)</span><br><span class="line">&#123;</span><br><span class="line">    ui-&gt;<span class="built_in">setupUi</span>(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    QMenuBar* bar = <span class="keyword">new</span> <span class="built_in">QMenuBar</span>();</span><br><span class="line">    <span class="comment">//将bar设置进自己的窗口</span></span><br><span class="line">    <span class="built_in">setMenuBar</span>(bar);<span class="comment">//将QMenuBar加入显示，此时并不会显示，因为没有选项卡</span></span><br><span class="line"></span><br><span class="line">    QMenu* file = bar-&gt;<span class="built_in">addMenu</span>(<span class="string">&quot;文件&quot;</span>);<span class="comment">//保留指针以添加下拉菜单</span></span><br><span class="line">    bar-&gt;<span class="built_in">addMenu</span>(<span class="string">&quot;编辑&quot;</span>);</span><br><span class="line">    bar-&gt;<span class="built_in">addMenu</span>(<span class="string">&quot;构建&quot;</span>);</span><br><span class="line"></span><br><span class="line">    file-&gt;<span class="built_in">addAction</span>(<span class="string">&quot;打开文件&quot;</span>);<span class="comment">//添加功能</span></span><br><span class="line">    file-&gt;<span class="built_in">addAction</span>(<span class="string">&quot;保存&quot;</span>);</span><br><span class="line">    file-&gt;<span class="built_in">addAction</span>(<span class="string">&quot;新建&quot;</span>);</span><br><span class="line">    file-&gt;<span class="built_in">addSeparator</span>();<span class="comment">//添加分隔符</span></span><br><span class="line"></span><br><span class="line">    QMenu* lastFile = file-&gt;<span class="built_in">addMenu</span>(<span class="string">&quot;最近访问文件&quot;</span>);<span class="comment">//子菜单</span></span><br><span class="line">    lastFile-&gt;<span class="built_in">addAction</span>(<span class="string">&quot;1.txt&quot;</span>);</span><br><span class="line">    lastFile-&gt;<span class="built_in">addAction</span>(<span class="string">&quot;2.txt&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MainWindow::~<span class="built_in">MainWindow</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">delete</span> ui;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/.io//3-3.png"></p><br><h4 id="3-2-2-工具栏-ToolBar"><a href="#3-2-2-工具栏-ToolBar" class="headerlink" title="3.2.2 工具栏 ToolBar"></a>3.2.2 工具栏 ToolBar</h4><blockquote><p>工具栏，如PS中的左侧工具栏，其可以随意拖动，可以放在软件左侧，上侧，下侧，右侧，甚至可以浮动在应用的界面当中。</p></blockquote><p>首先我们要知道，工具栏与菜单栏的区别：</p><ul><li>菜单栏只有一个，且是在最上方</li><li>而工具栏可以有多个，且位置可以多样化。</li></ul><p>QT中的工具栏类叫做<code>QToolBar</code>，首先查看帮助文档：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">Header:  <span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QToolBar&gt;</span></span></span><br><span class="line">CMake: <span class="built_in">find_package</span>(Qt6 REQUIRED COMPONENTS Widgets) </span><br><span class="line"><span class="built_in">target_link_libraries</span>(mytarget PRIVATE Qt6::Widgets)</span><br><span class="line">qmake: QT += widgets</span><br><span class="line">Inherits: QWidget</span><br><span class="line"></span><br><span class="line"><span class="comment">//QToolBar类中的两个构造函数</span></span><br><span class="line"><span class="built_in">QToolBar</span>(<span class="type">const</span> QString &amp;title, QWidget *parent = <span class="literal">nullptr</span>);</span><br><span class="line"><span class="built_in">QToolBar</span>(QWidget *parent = <span class="literal">nullptr</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建后需要绑定在父类QMainWindow类上</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">addToolBar</span><span class="params">(Qt::ToolBarArea area, QToolBar *toolbar)</span></span>;<span class="comment">//默认区域</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">addToolBar</span><span class="params">(QToolBar *toolbar)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Qt::ToolBarArea 工具栏方位</span></span><br><span class="line"><span class="comment">//enum Qt::ToolBarArea   flags Qt::ToolBarAreas</span></span><br><span class="line"><span class="comment">//Qt::LeftToolBarArea              0x1</span></span><br><span class="line"><span class="comment">//Qt::RightToolBarArea            0x2</span></span><br><span class="line"><span class="comment">//Qt::TopToolBarArea            0x4</span></span><br><span class="line"><span class="comment">//Qt::BottomToolBarArea            0x8</span></span><br><span class="line"><span class="comment">//Qt::AllToolBarAreas            ToolBarArea_Mask</span></span><br><span class="line"><span class="comment">//Qt::NoToolBarArea                0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//QToolBar类中的常用函数</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setAllowedAreas</span><span class="params">(Qt::ToolBarAreas areas)</span></span>;<span class="comment">//设置允许的区域</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setFloatable</span><span class="params">(<span class="type">bool</span> floatable)</span></span>;<span class="comment">//是否能够悬浮</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setMovable</span><span class="params">(<span class="type">bool</span> movable)</span></span>;<span class="comment">//是否可移动</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setOrientation</span><span class="params">(Qt::Orientation orientation)</span></span>;<span class="comment">//----待补充</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//继承自QWidget的Public函数</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">addAction</span><span class="params">(QAction *action)</span></span>;<span class="comment">//为工具栏添加工具</span></span><br><span class="line"><span class="comment">//可在其父类QWidget中查看其余的重载</span></span><br></pre></td></tr></table></figure><ul><li><p>添加 <code>#include &lt;QToolBar&gt;</code> 头文件。</p></li><li><p>创建 <code>QToolBar</code>，并指定父节点，同时将该工具栏加入父窗口。</p></li><li><p>设置工具栏方位：<code>Areas</code>【默认方位、限制可允许方位、限制移动、限制悬浮】</p></li><li><p>向工具栏添加工具：以上节的<code>QAction</code>为例</p></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;mainwindow.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ui_mainwindow.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QDebug&gt;</span></span></span><br><span class="line"></span><br><span class="line">MainWindow::<span class="built_in">MainWindow</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">QMainWindow</span>(parent)</span><br><span class="line">    , <span class="built_in">ui</span>(<span class="keyword">new</span> Ui::MainWindow)</span><br><span class="line">&#123;</span><br><span class="line">    ui-&gt;<span class="built_in">setupUi</span>(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    QMenuBar* bar = <span class="keyword">new</span> <span class="built_in">QMenuBar</span>(<span class="keyword">this</span>);</span><br><span class="line">    <span class="comment">//将bar设置进自己的窗口</span></span><br><span class="line">    <span class="built_in">setMenuBar</span>(bar);<span class="comment">//将QMenuBar加入显示，此时并不会显示，因为没有选项卡</span></span><br><span class="line"></span><br><span class="line">    QMenu* file = bar-&gt;<span class="built_in">addMenu</span>(<span class="string">&quot;文件&quot;</span>);<span class="comment">//保留指针以添加下拉菜单</span></span><br><span class="line">    bar-&gt;<span class="built_in">addMenu</span>(<span class="string">&quot;编辑&quot;</span>);</span><br><span class="line">    bar-&gt;<span class="built_in">addMenu</span>(<span class="string">&quot;构建&quot;</span>);</span><br><span class="line"></span><br><span class="line">    QAction* newFile = file-&gt;<span class="built_in">addAction</span>(<span class="string">&quot;新建&quot;</span>);</span><br><span class="line">    QAction* openFile = file-&gt;<span class="built_in">addAction</span>(<span class="string">&quot;打开文件&quot;</span>);<span class="comment">//添加功能</span></span><br><span class="line">    QAction* saveFile = file-&gt;<span class="built_in">addAction</span>(<span class="string">&quot;保存&quot;</span>);</span><br><span class="line">    file-&gt;<span class="built_in">addSeparator</span>();<span class="comment">//添加分隔符</span></span><br><span class="line"></span><br><span class="line">    QMenu* lastFile = file-&gt;<span class="built_in">addMenu</span>(<span class="string">&quot;最近访问文件&quot;</span>);<span class="comment">//子菜单</span></span><br><span class="line">    lastFile-&gt;<span class="built_in">addAction</span>(<span class="string">&quot;1.txt&quot;</span>);</span><br><span class="line">    lastFile-&gt;<span class="built_in">addAction</span>(<span class="string">&quot;2.txt&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//工具栏---------------------------------------------</span></span><br><span class="line">    QToolBar* toolBar = <span class="keyword">new</span> <span class="built_in">QToolBar</span>(<span class="keyword">this</span>);</span><br><span class="line">    <span class="comment">// addToolBar(toolBar);</span></span><br><span class="line">    <span class="built_in">addToolBar</span>(Qt::RightToolBarArea, toolBar);<span class="comment">//默认在右侧</span></span><br><span class="line">    toolBar-&gt;<span class="built_in">setAllowedAreas</span>(Qt::LeftToolBarArea|Qt::RightToolBarArea);<span class="comment">//只允许左右侧</span></span><br><span class="line">    toolBar-&gt;<span class="built_in">setFloatable</span>(<span class="literal">false</span>);<span class="comment">//不可悬浮</span></span><br><span class="line">    toolBar-&gt;<span class="built_in">setMovable</span>(<span class="literal">true</span>);<span class="comment">//可移动</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//为工具栏添加工具</span></span><br><span class="line">    toolBar-&gt;<span class="built_in">addAction</span>(newFile);</span><br><span class="line">    toolBar-&gt;<span class="built_in">addAction</span>(openFile);</span><br><span class="line">    toolBar-&gt;<span class="built_in">addAction</span>(saveFile);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MainWindow::~<span class="built_in">MainWindow</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">delete</span> ui;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/.io//3-4.png"></p><br><h4 id="3-2-3-状态栏-QStatusBar"><a href="#3-2-3-状态栏-QStatusBar" class="headerlink" title="3.2.3 状态栏 QStatusBar"></a>3.2.3 状态栏 QStatusBar</h4><p>什么是状态栏呢？状态栏一般用于显示一些状态，比如Notpad++的状态栏，其中显示了文字长度、行数、当前光标的位置、编码格式等。</p><p><img src="/.io//3-5.png"></p><p><strong>添加状态栏步骤：</strong></p><ul><li><p>查看<code>QStatusBar</code>类的帮助文档，该类负责状态栏的一些相关方法。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Header:  <span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QStatusBar&gt;</span></span></span><br><span class="line">qmake: QT += widgets</span><br><span class="line">Inherits: QWidget</span><br><span class="line">    </span><br><span class="line"><span class="comment">//使用QMainWindow中的方法创建QStatusBar，并绑定在父窗口上【状态栏只有一个：set】</span></span><br><span class="line">QStatusBar* statusBar = <span class="keyword">new</span> <span class="built_in">QStatusBar</span>(<span class="keyword">this</span>);</span><br><span class="line"><span class="keyword">this</span>-&gt;<span class="built_in">setStatusBar</span>(statusBar);</span><br><span class="line"></span><br><span class="line"><span class="comment">//QStatusBar常用函数</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">addWidget</span><span class="params">(QWidget *widget, <span class="type">int</span> stretch = <span class="number">0</span>)</span></span>;<span class="comment">//从左侧追加QLable</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">addPermanentWidget</span><span class="params">(QWidget *widget, <span class="type">int</span> stretch = <span class="number">0</span>)</span></span>;<span class="comment">//从右侧追加</span></span><br></pre></td></tr></table></figure><blockquote><p>注意函数命名上的不同：状态栏一般只有一个，故使用<code>this-&gt;setStatusBar(QStatusBar*);</code>，而工具栏可以有多个，故使用<code>this-&gt;addToolBar(QToolBar*);</code>。</p></blockquote></li><li><p>新建<code>QStatusBar</code>，并加入父窗口【此时，工具栏缩短了一点，其实是给状态栏留位置，但是状态栏里什么都没有】</p></li><li><p>新建 <code>QLabel</code> 类实例存储状态栏信息【Qt5可能出现中文乱码文件，详见3.2.4】</p><ul><li><p>加入<code>QLabel</code> 类的头文件</p></li><li><p>查看帮助文档</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Header:  <span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QLabel&gt;</span></span></span><br><span class="line">qmake: QT += widgets</span><br><span class="line">Inherits: QFrame</span><br><span class="line">  </span><br><span class="line"><span class="comment">//构造函数</span></span><br><span class="line"><span class="built_in">QLabel</span>(QWidget *parent = <span class="literal">nullptr</span>, Qt::WindowFlags f = Qt::<span class="built_in">WindowFlags</span>());</span><br><span class="line"><span class="built_in">QLabel</span>(<span class="type">const</span> QString &amp;text, QWidget *parent = <span class="literal">nullptr</span>, Qt::WindowFlags f = Qt::<span class="built_in">WindowFlags</span>());</span><br><span class="line"><span class="comment">//示例</span></span><br><span class="line">QLabel* label01 = <span class="keyword">new</span> <span class="built_in">QLabel</span>(<span class="string">&quot;RMB余额: 100&quot;</span>);</span><br><span class="line">QLabel* label01 = <span class="keyword">new</span> <span class="built_in">QLabel</span>(<span class="string">&quot;RMB余额: 100&quot;</span>, <span class="keyword">this</span>);</span><br></pre></td></tr></table></figure></li></ul></li><li><p>使用 <code>addWidget</code> 向状态栏加入 <code>QLabel</code></p></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;mainwindow.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ui_mainwindow.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QDebug&gt;</span></span></span><br><span class="line"></span><br><span class="line">MainWindow::<span class="built_in">MainWindow</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">QMainWindow</span>(parent)</span><br><span class="line">    , <span class="built_in">ui</span>(<span class="keyword">new</span> Ui::MainWindow)</span><br><span class="line">&#123;</span><br><span class="line">    ui-&gt;<span class="built_in">setupUi</span>(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    QMenuBar* bar = <span class="keyword">new</span> <span class="built_in">QMenuBar</span>(<span class="keyword">this</span>);</span><br><span class="line">    <span class="comment">//将bar设置进自己的窗口</span></span><br><span class="line">    <span class="built_in">setMenuBar</span>(bar);<span class="comment">//将QMenuBar加入显示，此时并不会显示，因为没有选项卡</span></span><br><span class="line"></span><br><span class="line">    QMenu* file = bar-&gt;<span class="built_in">addMenu</span>(<span class="string">&quot;文件&quot;</span>);<span class="comment">//保留指针以添加下拉菜单</span></span><br><span class="line">    bar-&gt;<span class="built_in">addMenu</span>(<span class="string">&quot;编辑&quot;</span>);</span><br><span class="line">    bar-&gt;<span class="built_in">addMenu</span>(<span class="string">&quot;构建&quot;</span>);</span><br><span class="line"></span><br><span class="line">    QAction* newFile = file-&gt;<span class="built_in">addAction</span>(<span class="string">&quot;新建&quot;</span>);</span><br><span class="line">    QAction* openFile = file-&gt;<span class="built_in">addAction</span>(<span class="string">&quot;打开文件&quot;</span>);<span class="comment">//添加功能</span></span><br><span class="line">    QAction* saveFile = file-&gt;<span class="built_in">addAction</span>(<span class="string">&quot;保存&quot;</span>);</span><br><span class="line">    file-&gt;<span class="built_in">addSeparator</span>();<span class="comment">//添加分隔符</span></span><br><span class="line"></span><br><span class="line">    QMenu* lastFile = file-&gt;<span class="built_in">addMenu</span>(<span class="string">&quot;最近访问文件&quot;</span>);<span class="comment">//子菜单</span></span><br><span class="line">    lastFile-&gt;<span class="built_in">addAction</span>(<span class="string">&quot;1.txt&quot;</span>);</span><br><span class="line">    lastFile-&gt;<span class="built_in">addAction</span>(<span class="string">&quot;2.txt&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//工具栏---------------------------------------------</span></span><br><span class="line">    QToolBar* toolBar = <span class="keyword">new</span> <span class="built_in">QToolBar</span>(<span class="keyword">this</span>);</span><br><span class="line">    <span class="comment">// addToolBar(toolBar);</span></span><br><span class="line">    <span class="built_in">addToolBar</span>(Qt::RightToolBarArea, toolBar);<span class="comment">//默认在右侧</span></span><br><span class="line">    toolBar-&gt;<span class="built_in">setAllowedAreas</span>(Qt::LeftToolBarArea|Qt::RightToolBarArea);<span class="comment">//只允许左右侧</span></span><br><span class="line">    toolBar-&gt;<span class="built_in">setFloatable</span>(<span class="literal">false</span>);<span class="comment">//不可悬浮</span></span><br><span class="line">    toolBar-&gt;<span class="built_in">setMovable</span>(<span class="literal">true</span>);<span class="comment">//可移动</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//为工具栏添加工具</span></span><br><span class="line">    toolBar-&gt;<span class="built_in">addAction</span>(newFile);</span><br><span class="line">    toolBar-&gt;<span class="built_in">addAction</span>(openFile);</span><br><span class="line">    toolBar-&gt;<span class="built_in">addAction</span>(saveFile);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//状态栏---------------------------------------------</span></span><br><span class="line">    QStatusBar* statusBar = <span class="keyword">new</span> <span class="built_in">QStatusBar</span>(<span class="keyword">this</span>);</span><br><span class="line">    <span class="built_in">setStatusBar</span>(statusBar);</span><br><span class="line"></span><br><span class="line">    QLabel* label01 = <span class="keyword">new</span> <span class="built_in">QLabel</span>(<span class="string">&quot;RMB余额: 100&quot;</span>, <span class="keyword">this</span>);</span><br><span class="line">    QLabel* label02 = <span class="keyword">new</span> <span class="built_in">QLabel</span>(<span class="string">&quot;美元余额: 36000&quot;</span>, <span class="keyword">this</span>);</span><br><span class="line">    statusBar-&gt;<span class="built_in">addWidget</span>(label01);<span class="comment">//从左侧开始追加</span></span><br><span class="line">    statusBar-&gt;<span class="built_in">addPermanentWidget</span>(label02);<span class="comment">//从右侧开始追加</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MainWindow::~<span class="built_in">MainWindow</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">delete</span> ui;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/.io//3-6.png"></p><br><h4 id="3-2-4-中文奇数乱码或直接乱码问题"><a href="#3-2-4-中文奇数乱码或直接乱码问题" class="headerlink" title="3.2.4 中文奇数乱码或直接乱码问题"></a>3.2.4 中文奇数乱码或直接乱码问题</h4><blockquote><p>中文奇数乱码或直接乱码问题出现在Qt5中。</p></blockquote><p>问题的产生：只要中文和中文符号的数量为奇数个，就可能产生部分文字或者符号为乱码。</p><p><img src="/.io//3-7.png"></p><p><strong>解决办法：</strong></p><p>在<code>QtCreater</code>中打开源码，然后在菜单编辑中选择 <code>Select Encoding</code>，找到GBK，选中后在对话框右下角选择按编码保存。【此时，可能界面中文全部乱码】</p><p>在所有需要中文字符的地方，改写为以下两种方式：</p><ul><li>字符串前加 <code>u8</code> 前缀：<code>bar-&gt;addMenu(u8&quot;编辑&quot;);</code>【u8为预处理指令】</li><li>使用<code>QStringLiteral</code>宏处理模式：<code>bar-&gt;addMenu(QStringLiteral(&quot;编辑&quot;));</code>【可屏蔽警告】【由于该宏处理函数的本质是修改为Lamabda函数，故不要在高频循环中使用】</li></ul><br><h4 id="3-2-5-铆接部件-浮动窗口-QDockWidget"><a href="#3-2-5-铆接部件-浮动窗口-QDockWidget" class="headerlink" title="3.2.5 铆接部件 浮动窗口 QDockWidget"></a>3.2.5 铆接部件 浮动窗口 QDockWidget</h4><p>查看 <code>QDockWidget</code> 帮助文档：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Header:  <span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QDockWidget&gt;</span></span></span><br><span class="line">qmake: QT += widgets</span><br><span class="line">Inherits: QWidget</span><br><span class="line"></span><br><span class="line"><span class="comment">//构造函数</span></span><br><span class="line"><span class="built_in">QDockWidget</span>(<span class="type">const</span> QString &amp;title, QWidget *parent = <span class="literal">nullptr</span>, Qt::WindowFlags flags = Qt::<span class="built_in">WindowFlags</span>());</span><br><span class="line"><span class="built_in">QDockWidget</span>(QWidget *parent = <span class="literal">nullptr</span>, Qt::WindowFlags flags = Qt::<span class="built_in">WindowFlags</span>());</span><br><span class="line">    </span><br><span class="line"><span class="comment">//使用QMainWindow的成员函数将QDockWidget加入窗口【浮动窗口可以有多个：add】</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">addDockWidget</span><span class="params">(Qt::DockWidgetArea area, QDockWidget *dockwidget)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">addDockWidget</span><span class="params">(Qt::DockWidgetArea area, QDockWidget *dockwidget, Qt::Orientation orientation)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//铆接部件QDockWidget的相关设置</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isAreaAllowed</span><span class="params">(Qt::DockWi;dgetArea area)</span> <span class="type">const</span></span>;<span class="comment">//获取该方位是否允许</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isFloating</span><span class="params">()</span> <span class="type">const</span></span>;<span class="comment">//获取浮动状态</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setAllowedAreas</span><span class="params">(Qt::DockWidgetAreas areas)</span></span>;<span class="comment">//允许的方位</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setFeatures</span><span class="params">(QDockWidget::DockWidgetFeatures features)</span></span>;<span class="comment">//特征</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setFloating</span><span class="params">(<span class="type">bool</span> floating)</span></span>;<span class="comment">//设置浮动状态</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setTitleBarWidget</span><span class="params">(QWidget *widget)</span></span>;<span class="comment">//设置标题</span></span><br><span class="line"></span><br><span class="line"><span class="function">QWidget *<span class="title">titleBarWidget</span><span class="params">()</span> <span class="type">const</span></span>;<span class="comment">//创建titleBar</span></span><br></pre></td></tr></table></figure><ol><li><p>加入头文件 <code>#include &lt;QDockWidget&gt;</code></p></li><li><p>创建 <code>QDockWidget</code>，并绑定在父窗口上【无中心部件，见下图】</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//在上一节的代码后追加，不再重复</span></span><br><span class="line">    <span class="comment">//浮动窗口--------------------------------------------</span></span><br><span class="line">    QDockWidget* dock01 = <span class="keyword">new</span> <span class="built_in">QDockWidget</span>(<span class="keyword">this</span>);</span><br><span class="line">    <span class="built_in">addDockWidget</span>(Qt::LeftDockWidgetArea, dock01);</span><br><span class="line">    <span class="comment">//此时铆接部件没有中心部件，中心为空</span></span><br></pre></td></tr></table></figure><p><img src="/.io//3-8.png"></p></li><li><p>加入中心部件【此处中心部件为 <code>QTextEdit</code> 编辑框】</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//中心部件</span></span><br><span class="line">QTextEdit* edit = <span class="keyword">new</span> <span class="built_in">QTextEdit</span>(<span class="keyword">this</span>);</span><br><span class="line"><span class="built_in">setCentralWidget</span>(edit);</span><br></pre></td></tr></table></figure><p><img src="/.io//3-9.png"></p></li><li><p>铆接部件的相关设置见帮助文档</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dock01-&gt;<span class="built_in">setAllowedAreas</span>(Qt::LeftDockWidgetArea|Qt::TopDockWidgetArea);</span><br><span class="line">dock01-&gt;<span class="built_in">setFloating</span>(<span class="literal">false</span>);</span><br></pre></td></tr></table></figure></li></ol><br><h3 id="3-3-UI设计器介绍"><a href="#3-3-UI设计器介绍" class="headerlink" title="3.3 UI设计器介绍"></a>3.3 UI设计器介绍</h3><p>在前几节中，我们使用代码的方式创建界面、部件、控件、布局，修改布局、添加布局等操作。</p><p>本节使用Qt的ui界面文件，启动UI设计器，可以在其中编辑控件。</p><ul><li>新建QMainWindow项目，命名为MyUI【自动生成时需要勾选 <code>xxx.iu</code> 文件，这样才能使用UI设计器】</li><li>打开mainWindow.cpp文件，注意到 <code>ui-&gt;setupUi(this);</code>【其实该语句是将ui文件绑定在该类上】</li><li>双击ui文件即可跳转UI设计器，进入设计界面。</li></ul><p>以下是对界面的介绍：</p><p><img src="/.io//3-10.png"></p><ul><li><p>在设计界面的左侧，有各式各样的控件、部件。如有需要，直接拖入布局即可【比如前几节提到过的按钮、文本编辑框】。</p></li><li><p>每个控件拖动进去之后，会有控制大小的八个小点，可以用鼠标点击并拖动其中的小点，改变部件的大小；也可以点击移动位置，也可以单击该部件后，在设计界面的右下角调整它的参数。</p></li><li><p>下方与<code>Action 编辑器</code>并列的<code>信号和槽编辑器</code>，可以添加connect关系。</p></li><li><p>Action编辑器可用于编辑Menu中的Action，可拖动添加菜单选项。</p><p><img src="/.io//3-11.png"></p></li><li><p>将Action编辑器中Action拖动到工具栏ToolBar</p></li><li><p>添加铆接部件Dock Widget</p></li></ul><p>对于右下角参数部分，做简要介绍：</p><ol><li><p><code>objectName</code>：对象名称，通过ui界面方式添加的按钮或其他对象，都可以通过【<code>ui-&gt;对象名</code>】来访问对象。【假如我们要访问该对象并修改其显示名称为“我的按钮”，可以这样做】</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ui-&gt;[对象名]-&gt;<span class="built_in">setText</span>(<span class="string">&quot;我的按钮&quot;</span>);</span><br></pre></td></tr></table></figure></li><li><p><code>text</code>：对象文本</p></li><li><p><code>cursor</code>：光标样式</p></li><li><p><code>layoutDirection</code>：编写顺序，从左至右，还是从右至左</p></li><li><p><code>readOnly</code>：是否只读，勾选之后不能编辑，只能读</p></li><li><p><code>placeholderText</code>：当编辑框为空的时候的背景提示字符，颜色较暗，当用户输入后，字符消失。</p></li><li><p>…</p></li></ol><br><h3 id="3-4-添加图标Icon"><a href="#3-4-添加图标Icon" class="headerlink" title="3.4 添加图标Icon"></a>3.4 添加图标Icon</h3><blockquote><p>Qt中添加图标有两种方式，一种是通过代码直接添加；另一种是添加资源文件。</p></blockquote><h4 id="3-4-1-代码方式添加图标"><a href="#3-4-1-代码方式添加图标" class="headerlink" title="3.4.1 代码方式添加图标"></a>3.4.1 代码方式添加图标</h4><p>之前几节中在项目中添加了很多选项卡【Action】，对QAction对象来说，都可以设置唯一的图标，故相应的类函数为：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//QAction</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setIcon</span><span class="params">(<span class="type">const</span> QIcon &amp;icon)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//QIcon</span></span><br><span class="line"><span class="built_in">QIcon</span>();</span><br><span class="line"><span class="built_in">QIcon</span>(<span class="type">const</span> QPixmap &amp;pixmap);</span><br><span class="line"><span class="built_in">QIcon</span>(<span class="type">const</span> QString &amp;fileName);<span class="comment">//此处使用本地文件路径创建Icon</span></span><br><span class="line"><span class="built_in">QIcon</span>(QIconEngine *engine);</span><br><span class="line"><span class="built_in">QIcon</span>(<span class="type">const</span> QIcon &amp;other);</span><br><span class="line"><span class="built_in">QIcon</span>(QIcon &amp;&amp;other);</span><br></pre></td></tr></table></figure><p>在<code>mainwindow.cpp</code>中编写代码，使用ui对象找到QAction对象，然后设置图标：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 将ui文件绑定在MainWindow上后，即可使用ui中定义的组件</span></span><br><span class="line">    ui-&gt;<span class="built_in">setupUi</span>(<span class="keyword">this</span>);</span><br><span class="line">    ui-&gt;actionNew-&gt;<span class="built_in">setIcon</span>(<span class="built_in">QIcon</span>(<span class="string">&quot;E:\\About Chase\\Art of Programming-2024\\Qt\\icons\\tiger.png&quot;</span>));</span><br></pre></td></tr></table></figure><p><img src="/.io//3-12.png"></p><blockquote><p>新建图标为使用代码方式添加，保存图标为UI界面中用资源文件添加。</p></blockquote><br><h4 id="3-4-2-添加资源文件"><a href="#3-4-2-添加资源文件" class="headerlink" title="3.4.2 添加资源文件"></a>3.4.2 添加资源文件</h4><p>使用代码添加图标，存在路径的问题，即必须使用绝对路径【更换运行环境后绝对路径失效】。</p><p>相应地，将所需的图标都添加为资源文件，即可避免路径问题。添加资源文件的步骤如下：</p><ol><li>把项目所需要的图标文件夹整体复制到项目文件夹下【必需】。</li><li>回到Qt，右击项目&gt;<code>Add New</code>【添加新文件】，在对话框中选择<code>Qt</code> -&gt; <code>Qt Resource File</code></li><li>在弹出的对话框中，填写新建的资源文件名称【如res】，路径必须选择默认，即放在该项目的文件夹下。</li><li>系统自动添加资源文件到项目中，<code>.qrc</code>就是Qt的资源文件的后缀名。</li><li>现在我们进入了资源文件的编辑界面【在左侧项目树目录中，已经新增一个Resource的主项目，里面有新建的资源文件】</li><li>双击【或默认打开】<code>res.pro</code>进行编辑。添加前缀【即目录分级】，此处前缀为<code>/icons</code>。然后选择添加文件，选择全部图标并添加，此刻完成资源文件Icon的添加。</li></ol><p><img src="/.io//3-13.png"></p><p>可以在ui文件中直接使用资源文件中的图标 ，如上上图中的保存图标。</p><p>加入资源文件后，也可以简化使用代码添加图标的路径：【<code>: + 前缀名 + 文件路径名</code>】</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ui-&gt;<span class="built_in">setupUi</span>(<span class="keyword">this</span>);</span><br><span class="line"><span class="comment">// ui-&gt;actionNew-&gt;setIcon(QIcon(&quot;E:\\About Chase\\Art of Programming-2024\\Qt\\icons\\tiger.png&quot;));</span></span><br><span class="line"><span class="comment">// 添加资源文件后</span></span><br><span class="line">ui-&gt;actionNew-&gt;<span class="built_in">setIcon</span>(<span class="built_in">QIcon</span>(<span class="string">&quot;:/icons\\icons\\tiger.png&quot;</span>));</span><br></pre></td></tr></table></figure><p>🔺<strong>特别注意</strong>：资源文件名应用英文命名，否则找不到资源文件。</p><br><h3 id="3-5-对话框-Dialog"><a href="#3-5-对话框-Dialog" class="headerlink" title="3.5 对话框 Dialog"></a>3.5 对话框 Dialog</h3><p>在图形用户界面中，对话框【又称对话方块】是一种特殊的视窗，用来在用户界面中向用户显示信息，或者在需要的时候获得用户的输入响应。</p><p>之所以称之为对话框，是因为它们使计算机和用户之间构成了一个对话，或者是通知用户一些信息，或者是请求用户的输入，或者两者皆有。</p><h4 id="3-5-1-标准对话框"><a href="#3-5-1-标准对话框" class="headerlink" title="3.5.1 标准对话框"></a>3.5.1 标准对话框</h4><p>标准对话框是Qt内置的一系列对话框，用于简化开发。也可以说就是Qt系统自带的，开箱即用的。</p><p>QT内置的对话框包含：</p><ul><li><p>QColorDialog：选择颜色对话框</p></li><li><p>QFileDialog：选择文件或目录</p></li><li><p>QFontDialog：选择字体</p></li><li><p>QInputDialog：允许用户输入一个值，并将其值返回</p></li><li><p>MessageBoxDialog：模态对话框，用于显示信息、询问问题等。</p></li></ul><br><h4 id="3-5-2-模态和非模态对话框"><a href="#3-5-2-模态和非模态对话框" class="headerlink" title="3.5.2 模态和非模态对话框"></a>3.5.2 模态和非模态对话框</h4><p>简单来说，区别非常明显：</p><ul><li>模态对话框：展示对话框时，不能对其他窗口进行操作，独占用户的所有输入【一般被认为用户正在进行重要行为】。</li><li>非模态对话框：展示对话框时，可以对其他窗口进行操作【一般只是提示关系】。</li></ul><p>例如，在Qt Create界面，点击帮助-&gt;关于插件，会弹出一个【已安装插件】对话框。</p><blockquote><p>此时，尝试操作对话框以外的区域，是不可以进行其他操作的；此对话框之外进行任何操作都无效，而且此对话框还会一闪一闪，伴随着噔噔的警告声音。</p><p>意思是：提示用户，在这个应用中，弹出了这个窗口，在这个对话框关闭之前，你只能对这个对话框进行操作，不能进行其他操作，像这类对话框，就叫做模态对话框。</p></blockquote><p>关闭对话框，在点击帮助-&gt;About Qt Create…，也会弹出一个对话框。</p><blockquote><p>不关闭该对话框，点击Qt Create的其他地方，甚至把这个窗口移动到一遍，继续些代码，都是被允许的。</p><p>也就是说，此对话框是否关闭，对原窗口的操作没有任何影响。此类对话框，就叫做非模态对话框。</p></blockquote><p>需要注意的是：</p><ul><li>模态对话框会阻塞在对话框，除非接收到用户的特定输入，否则会一直卡住；而非模态对话框不会阻塞。</li><li>与铆接窗口相比，铆接窗口也是非模态的。</li></ul><br><h4 id="3-5-3-自定义对话框"><a href="#3-5-3-自定义对话框" class="headerlink" title="3.5.3 自定义对话框"></a>3.5.3 自定义对话框</h4><p><strong>设计需求：</strong>点击新建Action，弹出一个对话框。</p><ol><li>新建QMainWindow类的项目：myDialog项目</li><li>与3.4节一样，在菜单栏MenuBar新建3个子项【新建、打开、保存】</li><li>查看帮助文档中QAction类提供的信号类型：此处使用 <code>QAction::triggered</code></li><li>初步实现需求【需要头文件：<code>&lt;QDialog&gt;</code>】</li></ol><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;mainwindow.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ui_mainwindow.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QDebug&gt;</span></span></span><br><span class="line"></span><br><span class="line">MainWindow::<span class="built_in">MainWindow</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">QMainWindow</span>(parent)</span><br><span class="line">    , <span class="built_in">ui</span>(<span class="keyword">new</span> Ui::MainWindow)</span><br><span class="line">&#123;</span><br><span class="line">    ui-&gt;<span class="built_in">setupUi</span>(<span class="keyword">this</span>);</span><br><span class="line">    ui-&gt;actionNew-&gt;<span class="built_in">setIcon</span>(<span class="built_in">QIcon</span>(<span class="string">&quot;:/icons\\icons\\tiger.png&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="built_in">connect</span>(ui-&gt;actionNew, &amp;QAction::triggered, [=]&#123;</span><br><span class="line">        <span class="comment">//QDialog dlg1(this);//构造一个对话框对象，指定父类this</span></span><br><span class="line">        <span class="comment">// dlg1.exec();//模态对话框</span></span><br><span class="line">        QDialog* dlg2 = <span class="keyword">new</span> <span class="built_in">QDialog</span>(<span class="keyword">this</span>);</span><br><span class="line">        dlg2-&gt;<span class="built_in">resize</span>(<span class="number">200</span>,<span class="number">100</span>);</span><br><span class="line">        <span class="comment">//dlg2-&gt;setAttribute(Qt::WA_DeleteOnClose);</span></span><br><span class="line">        dlg2-&gt;<span class="built_in">show</span>();</span><br><span class="line">        <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;打开对话框&quot;</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MainWindow::~<span class="built_in">MainWindow</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">delete</span> ui;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>🔺在Lamabda函数中，以栈的方式使用非模态对话框，会出现一闪而过的情况。</p><p>原因是：非模态对话框不会阻塞程序，Lamabda函数执行完毕就被析构，故对话框一闪而过。</p><p>解决：将新建的对话框创建在堆上而不是栈上。</p></blockquote><p>最后值得注意的是，如果用new在堆上创建了非模态的对话框，且一直打开新的非模态对话框，就存在堆内存泄露的风险。</p><blockquote><p>虽然这些对话框确实都指定了this为父亲，只要关闭主窗口，这些对话框的对象，就会被一一释放。</p><p>但有如果主窗口不关闭，且不停地新建和关闭非模态对话框，次数多了，肯定是会出现内存泄漏。因为关闭对话框的动作，并不会释放对话框对象占用的对内存，只有关闭主窗口才会释放内存。</p></blockquote><p><strong>解决办法：</strong>在对话框中，设置属性 <code>QWidget::setAttribute</code>【QDialog是QWidget的子类】。查看<code>setAttribute</code>的帮助文档：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">setAttribute</span><span class="params">(Qt::WidgetAttribute attribute, <span class="type">bool</span> on = <span class="literal">true</span>)</span></span>;</span><br><span class="line"><span class="comment">//两个参数。当第二个参数on为真，就设置属性；否则就清除属性。</span></span><br><span class="line"><span class="comment">//on默认为true，即默认设置属性</span></span><br><span class="line"><span class="comment">//第一个参数WidgetAttribute为枚举类型[仅介绍55]</span></span><br><span class="line"><span class="comment">//Qt::WA_DeleteOnClose   55 【该部件关闭的时候，就delete该对象】</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//创建并设置属性</span></span><br><span class="line">dlg2-&gt;<span class="built_in">setAttribute</span>(Qt::WA_DeleteOnClose);</span><br></pre></td></tr></table></figure><br><h4 id="3-5-4-QMessageBox对话框"><a href="#3-5-4-QMessageBox对话框" class="headerlink" title="3.5.4 QMessageBox对话框"></a>3.5.4 QMessageBox对话框</h4><p>QMessageBox对话框，用于在程序中提供显示信息、弹出询问、弹出警告等。</p><blockquote><p>例如在记事本中编辑文本，在没有保存的时候点击关闭，那么系统就会友情的弹出一个询问QMessageBox对话框，询问是否需要保存。</p></blockquote><blockquote><p>注意：<code>QMessageBox</code>都是模态对话框，在弹出消息的时候，必须要处理消息，否则不能做其他操作。</p></blockquote><p>查看帮助文档：QMessageBox类</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">Header:  <span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QMessageBox&gt;</span> <span class="comment">//需要包含的头文件</span></span></span><br><span class="line">qmake: QT += widgets</span><br><span class="line">Inherits: QDialog<span class="comment">//继承自QDialog，故本质上QMessageBox可以有非模态的形式</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">//可直接通过类名调用的公共静态方法：【模态对话框】【可以记录返回值】</span></span><br><span class="line"><span class="comment">//Critical消息框，也叫危险消息框，一般用于出现错误的时候</span></span><br><span class="line">QMessageBox::StandardButton <span class="built_in">critical</span>(</span><br><span class="line">    QWidget *parent,<span class="comment">//父亲，这里都可以使用this</span></span><br><span class="line">    <span class="type">const</span> QString &amp;title,<span class="comment">//标题</span></span><br><span class="line">    <span class="type">const</span> QString &amp;text,<span class="comment">//错误信息</span></span><br><span class="line">    QMessageBox::StandardButtons buttons = Ok,<span class="comment">//按钮类型</span></span><br><span class="line">    QMessageBox::StandardButton defaultButton = NoButton);<span class="comment">//默认按钮</span></span><br><span class="line"><span class="comment">//信息，起一个提示作用</span></span><br><span class="line"><span class="function">QMessageBox::StandardButton <span class="title">information</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    QWidget *parent,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">const</span> QString &amp;title,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">const</span> QString &amp;text, </span></span></span><br><span class="line"><span class="params"><span class="function">    QMessageBox::StandardButtons buttons = Ok,</span></span></span><br><span class="line"><span class="params"><span class="function">    QMessageBox::StandardButton defaultButton = NoButton)</span></span>;</span><br><span class="line"><span class="comment">//警告，提示警告</span></span><br><span class="line"><span class="function">QMessageBox::StandardButton <span class="title">warning</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    QWidget *parent,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">const</span> QString &amp;title,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">const</span> QString &amp;text, </span></span></span><br><span class="line"><span class="params"><span class="function">    QMessageBox::StandardButtons buttons = Ok,</span></span></span><br><span class="line"><span class="params"><span class="function">    QMessageBox::StandardButton defaultButton = NoButton)</span></span>;</span><br><span class="line"><span class="comment">//[特殊]询问，在计算机需要用户做决定的时候一个询问，如是否保存消息框</span></span><br><span class="line"><span class="function">QMessageBox::StandardButton <span class="title">question</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    QWidget *parent,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">const</span> QString &amp;title,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">const</span> QString &amp;text, </span></span></span><br><span class="line"><span class="params"><span class="function">    QMessageBox::StandardButtons buttons = StandardButtons(Yes | No), </span></span></span><br><span class="line"><span class="params"><span class="function">    QMessageBox::StandardButton defaultButton = NoButton)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//返回值类型int 或QMessageBox::StandardButton【枚举】</span></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">StandardButton</span> &#123;</span><br><span class="line">        <span class="comment">// keep this in sync with QDialogButtonBox::StandardButton and QPlatformDialogHelper::StandardButton</span></span><br><span class="line">        NoButton           = <span class="number">0x00000000</span>,</span><br><span class="line">        Ok                 = <span class="number">0x00000400</span>,</span><br><span class="line">        Save               = <span class="number">0x00000800</span>,</span><br><span class="line">        SaveAll            = <span class="number">0x00001000</span>,</span><br><span class="line">        Open               = <span class="number">0x00002000</span>,</span><br><span class="line">        Yes                = <span class="number">0x00004000</span>,</span><br><span class="line">        YesToAll           = <span class="number">0x00008000</span>,</span><br><span class="line">        No                 = <span class="number">0x00010000</span>,</span><br><span class="line">        NoToAll            = <span class="number">0x00020000</span>,</span><br><span class="line">        Abort              = <span class="number">0x00040000</span>,</span><br><span class="line">        Retry              = <span class="number">0x00080000</span>,</span><br><span class="line">        Ignore             = <span class="number">0x00100000</span>,</span><br><span class="line">        Close              = <span class="number">0x00200000</span>,</span><br><span class="line">        Cancel             = <span class="number">0x00400000</span>,</span><br><span class="line">        Discard            = <span class="number">0x00800000</span>,</span><br><span class="line">        Help               = <span class="number">0x01000000</span>,</span><br><span class="line">        Apply              = <span class="number">0x02000000</span>,</span><br><span class="line">        Reset              = <span class="number">0x04000000</span>,</span><br><span class="line">        RestoreDefaults    = <span class="number">0x08000000</span>,</span><br><span class="line">        FirstButton        = Ok,                <span class="comment">// internal</span></span><br><span class="line">        LastButton         = RestoreDefaults,   <span class="comment">// internal</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>接着上一节的代码，要求点击按钮弹出QMessageBox对话框【 <code>critical</code> | <code>information</code> | <code>warning</code> | <code>question</code>】。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//已在ui编辑器中添加了四个按钮，并命名为pb01-pb04</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;mainwindow.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ui_mainwindow.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QDebug&gt;</span></span></span><br><span class="line"></span><br><span class="line">MainWindow::<span class="built_in">MainWindow</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">QMainWindow</span>(parent)</span><br><span class="line">    , <span class="built_in">ui</span>(<span class="keyword">new</span> Ui::MainWindow)</span><br><span class="line">&#123;</span><br><span class="line">    ui-&gt;<span class="built_in">setupUi</span>(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">connect</span>(ui-&gt;pb01, &amp;QPushButton::clicked, <span class="keyword">this</span>, [=]()&#123;</span><br><span class="line">        <span class="comment">// QMessageBox* msg = new QMessageBox(this);</span></span><br><span class="line">        <span class="comment">// msg-&gt;information(this, &quot;提示&quot;, &quot;你吃饭了吗？&quot;);</span></span><br><span class="line">        <span class="comment">// QMessageBox::information(this, &quot;提示&quot;, &quot;你吃饭了吗？&quot;);//推荐写法</span></span><br><span class="line">        <span class="type">int</span> ret = QMessageBox::<span class="built_in">information</span>(<span class="keyword">this</span>, <span class="string">&quot;提示&quot;</span>, <span class="string">&quot;你吃饭了吗？&quot;</span>, QMessageBox::Yes|QMessageBox::No, QMessageBox::Yes);</span><br><span class="line">        <span class="keyword">if</span>(ret == QMessageBox::Yes)&#123;</span><br><span class="line">            <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;是的，我已经吃过了！&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;没，不饿！&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">connect</span>(ui-&gt;pb02, &amp;QPushButton::clicked, <span class="keyword">this</span>, [=]()&#123;</span><br><span class="line">        QMessageBox::<span class="built_in">warning</span>(<span class="keyword">this</span>, <span class="string">&quot;警告&quot;</span>, <span class="string">&quot;你已经吃饭了！&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">connect</span>(ui-&gt;pb03, &amp;QPushButton::clicked, <span class="keyword">this</span>, [=]()&#123;</span><br><span class="line">        QMessageBox::<span class="built_in">critical</span>(<span class="keyword">this</span>, <span class="string">&quot;危险&quot;</span>, <span class="string">&quot;你已经吃了两顿饭了！&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">connect</span>(ui-&gt;pb04, &amp;QPushButton::clicked, <span class="keyword">this</span>, [=]()&#123;</span><br><span class="line">        QMessageBox::<span class="built_in">question</span>(<span class="keyword">this</span>, <span class="string">&quot;提问&quot;</span>, <span class="string">&quot;你吃饭了吗？&quot;</span>);<span class="comment">//默认两个按钮，默认选中yes</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MainWindow::~<span class="built_in">MainWindow</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">delete</span> ui;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/.io//3-14.png"></p><blockquote><p><code>QMessageBox</code> 推荐直接使用静态成员函数。</p></blockquote><br><h3 id="3-6-基本对话框"><a href="#3-6-基本对话框" class="headerlink" title="3.6 基本对话框"></a>3.6 基本对话框</h3><p>在这里，我们介绍几个比较常用的基本对话框。</p><blockquote><p>基本对话框是系统提供的、通用的对话框，开发者只需要学习并直接使用即可。</p></blockquote><ul><li>选择颜色对话框【模态】</li><li>文件对话框【模态】</li><li>字体选择对话框【模态】</li><li>其他对话框</li></ul><p>下面新建一个<code>QWidget</code>项目，项目名BasicDialog，类名MyWidget。在UI界面创建一个按钮，设置文本：基本对话框。</p><p><strong>设计需求：</strong>点击该按钮，弹出常用的基本对话框。</p><br><h4 id="3-6-1-选择颜色对话框-QColorDialog"><a href="#3-6-1-选择颜色对话框-QColorDialog" class="headerlink" title="3.6.1 选择颜色对话框 QColorDialog"></a>3.6.1 选择颜色对话框 QColorDialog</h4><p>具体需求：通过颜色对话框获取用户选择的一种颜色。</p><p>首先查看帮助文档：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">Header:  <span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QColorDialog&gt;</span>    <span class="comment">//必须添加头文件</span></span></span><br><span class="line">qmake: QT += widgets</span><br><span class="line">Inherits: QDialog</span><br><span class="line">    </span><br><span class="line"><span class="comment">//QColorDialog 静态成员函数</span></span><br><span class="line"><span class="comment">//获取对话框颜色</span></span><br><span class="line">QColor <span class="built_in">getColor</span>(</span><br><span class="line">    <span class="type">const</span> QColor &amp;initial = Qt::white,         <span class="comment">//默认颜色</span></span><br><span class="line">    QWidget *parent = <span class="literal">nullptr</span>,                 <span class="comment">//父组件</span></span><br><span class="line">    <span class="type">const</span> QString &amp;title = <span class="built_in">QString</span>(),         <span class="comment">//标题</span></span><br><span class="line">    QColorDialog::ColorDialogOptions options = <span class="built_in">ColorDialogOptions</span>()<span class="comment">//对话框选项</span></span><br><span class="line">    <span class="comment">//该字段有默认值，一般可以不填</span></span><br><span class="line">    <span class="comment">//QColorDialog::ShowAlphaChannel     0x00000001</span></span><br><span class="line">    <span class="comment">//QColorDialog::NoButtons			0x00000002Don</span></span><br><span class="line">    <span class="comment">//QColorDialog::DontUseNativeDialog	0x00000004</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">//QColor构造函数：rgb三原色 + alpha通道不透明度</span></span><br><span class="line"><span class="built_in">QColor</span>(<span class="type">int</span> r, <span class="type">int</span> g, <span class="type">int</span> b, <span class="type">int</span> a = <span class="number">255</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//第一个参数来自Qt命名空间下的常用颜色枚举类</span></span><br><span class="line"><span class="keyword">namespace</span> Qt &#123;</span><br><span class="line">    <span class="built_in">Q_NAMESPACE_EXPORT</span>(Q_CORE_EXPORT)</span><br><span class="line">    <span class="keyword">enum</span> <span class="title class_">GlobalColor</span> &#123;</span><br><span class="line">        color0,</span><br><span class="line">        color1,</span><br><span class="line">        black,<span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在<code>mywidget.cpp</code>中编写代码</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;mywidget.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ui_mywidget.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QColorDialog&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QFileDialog&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QDebug&gt;</span></span></span><br><span class="line"></span><br><span class="line">MyWidget::<span class="built_in">MyWidget</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">QWidget</span>(parent)</span><br><span class="line">    , <span class="built_in">ui</span>(<span class="keyword">new</span> Ui::MyWidget)</span><br><span class="line">&#123;</span><br><span class="line">    ui-&gt;<span class="built_in">setupUi</span>(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">connect</span>(ui-&gt;pbColor, &amp;QPushButton::clicked, <span class="keyword">this</span>, [=]()&#123;</span><br><span class="line">        QColor clr = QColorDialog::<span class="built_in">getColor</span>(Qt::cyan, <span class="keyword">this</span>, <span class="string">&quot;选择颜色&quot;</span>);</span><br><span class="line">        <span class="built_in">qDebug</span>()&lt;&lt;clr;</span><br><span class="line">        <span class="built_in">qDebug</span>()&lt;&lt;clr.<span class="built_in">red</span>()&lt;&lt;clr.<span class="built_in">green</span>()&lt;&lt;clr.<span class="built_in">blue</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">//QColor(ARGB 1, 0, 1, 1)</span></span><br><span class="line">    <span class="comment">//0 255 255</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">connect</span>(ui-&gt;pbsavefile, &amp;QPushButton::clicked, <span class="keyword">this</span>, [=]()&#123;</span><br><span class="line">        QString url = QFileDialog::<span class="built_in">getSaveFileName</span>(<span class="keyword">this</span>, <span class="string">&quot;保存文件&quot;</span>, <span class="string">&quot;C:\\&quot;</span>, <span class="string">&quot;*.txt;*.cpp;*.h&quot;</span>);</span><br><span class="line">        <span class="built_in">qDebug</span>()&lt;&lt;url;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">//&quot;C:/Users/Stell/mumu_boot.txt&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">connect</span>(ui-&gt;pbopenfile, &amp;QPushButton::clicked, <span class="keyword">this</span>, [=]()&#123;</span><br><span class="line">        QString url = QFileDialog::<span class="built_in">getOpenFileName</span>(<span class="keyword">this</span>, <span class="string">&quot;保存文件&quot;</span>, <span class="string">&quot;C:\\&quot;</span>, <span class="string">&quot;*.txt;*.cpp;*.h&quot;</span>);</span><br><span class="line">        <span class="built_in">qDebug</span>()&lt;&lt;url;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">//&quot;C:/Users/Stell/mumu_boot.txt&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MyWidget::~<span class="built_in">MyWidget</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">delete</span> ui;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>编译运行，点击按钮，就会弹出选择颜色对话框，有默认选择颜色直接选择或自行选择，最后输出选择的颜色。</p><p><img src="/.io//3-15.png"></p><br><h4 id="3-6-2-文件选择对话框-QFileDialog"><a href="#3-6-2-文件选择对话框-QFileDialog" class="headerlink" title="3.6.2 文件选择对话框 QFileDialog"></a>3.6.2 文件选择对话框 QFileDialog</h4><p>首先查看帮助文档</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">Header:  <span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QFileDialog&gt;</span>        <span class="comment">//必须加入头文件</span></span></span><br><span class="line">qmake: QT += widgets</span><br><span class="line">Inherits: QDialog</span><br><span class="line">    </span><br><span class="line"><span class="comment">//QFileDialog静态成员函数</span></span><br><span class="line">QString <span class="built_in">getExistingDirectory</span>(QWidget *parent = <span class="literal">nullptr</span>, <span class="type">const</span> QString &amp;caption = <span class="built_in">QString</span>(), <span class="type">const</span> QString &amp;dir = <span class="built_in">QString</span>(), QFileDialog::Options options = ShowDirsOnly);</span><br><span class="line"><span class="function">QUrl <span class="title">getExistingDirectoryUrl</span><span class="params">(QWidget *parent = <span class="literal">nullptr</span>, <span class="type">const</span> QString &amp;caption = QString(), <span class="type">const</span> QUrl &amp;dir = QUrl(), QFileDialog::Options options = ShowDirsOnly, <span class="type">const</span> QStringList &amp;supportedSchemes = QStringList())</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">getOpenFileContent</span><span class="params">(<span class="type">const</span> QString &amp;nameFilter, <span class="type">const</span> std::function&lt;<span class="type">void</span> (<span class="type">const</span> QString &amp;, <span class="type">const</span> QByteArray &amp;)&gt; &amp;fileOpenCompleted)</span></span>;</span><br><span class="line"><span class="comment">//获取要打开的文件路径【字符串】，不会真正打开文件</span></span><br><span class="line"><span class="comment">//右下角按钮为：打开文件</span></span><br><span class="line"><span class="comment">//返回QString：文件完整路径</span></span><br><span class="line"><span class="function">QString <span class="title">getOpenFileName</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    QWidget *parent = <span class="literal">nullptr</span>,             <span class="comment">//父组件</span></span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">const</span> QString &amp;caption = QString(), <span class="comment">//标题</span></span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">const</span> QString &amp;dir = QString(),        <span class="comment">//默认目录</span></span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">const</span> QString &amp;filter = QString(),    <span class="comment">//过滤器</span></span></span></span><br><span class="line"><span class="params"><span class="function">    QString *selectedFilter = <span class="literal">nullptr</span>,     <span class="comment">//默认选择文件</span></span></span></span><br><span class="line"><span class="params"><span class="function">    QFileDialog::Options options = Options()    <span class="comment">//默认选项</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>;</span><br><span class="line"><span class="comment">//获取要打开的多个文件路径【字符串列表】，不会真正打开文件</span></span><br><span class="line"><span class="comment">//右下角按钮为：打开文件</span></span><br><span class="line"><span class="comment">//返回QStringList：文件完整路径列表</span></span><br><span class="line"><span class="function">QStringList <span class="title">getOpenFileNames</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    QWidget *parent = <span class="literal">nullptr</span>, </span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">const</span> QString &amp;caption = QString(), </span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">const</span> QString &amp;dir = QString(), </span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">const</span> QString &amp;filter = QString(), </span></span></span><br><span class="line"><span class="params"><span class="function">    QString *selectedFilter = <span class="literal">nullptr</span>, </span></span></span><br><span class="line"><span class="params"><span class="function">    QFileDialog::Options options = Options()</span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>;</span><br><span class="line"><span class="function">QUrl <span class="title">getOpenFileUrl</span><span class="params">(QWidget *parent = <span class="literal">nullptr</span>, <span class="type">const</span> QString &amp;caption = QString(), <span class="type">const</span> QUrl &amp;dir = QUrl(), <span class="type">const</span> QString &amp;filter = QString(), QString *selectedFilter = <span class="literal">nullptr</span>, QFileDialog::Options options = Options(), <span class="type">const</span> QStringList &amp;supportedSchemes = QStringList())</span></span>;</span><br><span class="line"><span class="function">QList&lt;QUrl&gt; <span class="title">getOpenFileUrls</span><span class="params">(QWidget *parent = <span class="literal">nullptr</span>, <span class="type">const</span> QString &amp;caption = QString(), <span class="type">const</span> QUrl &amp;dir = QUrl(), <span class="type">const</span> QString &amp;filter = QString(), QString *selectedFilter = <span class="literal">nullptr</span>, QFileDialog::Options options = Options(), <span class="type">const</span> QStringList &amp;supportedSchemes = QStringList())</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//保存文件，但需要代码编写保存细节，否则只是返回一个字符串而已</span></span><br><span class="line"><span class="comment">//右下角按钮为：保存文件</span></span><br><span class="line"><span class="comment">//返回QString：文件完整路径</span></span><br><span class="line"><span class="function">QString <span class="title">getSaveFileName</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    QWidget *parent = <span class="literal">nullptr</span>,                <span class="comment">//父组件</span></span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">const</span> QString &amp;caption = QString(),        <span class="comment">//标题</span></span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">const</span> QString &amp;dir = QString(),            <span class="comment">//默认路径</span></span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">const</span> QString &amp;filter = QString(),        <span class="comment">//过滤器，如*.txt;*.cpp;*.h</span></span></span></span><br><span class="line"><span class="params"><span class="function">    QString *selectedFilter = <span class="literal">nullptr</span>,        <span class="comment">//默认，一般不填</span></span></span></span><br><span class="line"><span class="params"><span class="function">    QFileDialog::Options options = Options()<span class="comment">//默认，一般不填</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function">QUrl <span class="title">getSaveFileUrl</span><span class="params">(QWidget *parent = <span class="literal">nullptr</span>, <span class="type">const</span> QString &amp;caption = QString(), <span class="type">const</span> QUrl &amp;dir = QUrl(), <span class="type">const</span> QString &amp;filter = QString(), QString *selectedFilter = <span class="literal">nullptr</span>, QFileDialog::Options options = Options(), <span class="type">const</span> QStringList &amp;supportedSchemes = QStringList())</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">saveFileContent</span><span class="params">(<span class="type">const</span> QByteArray &amp;fileContent, <span class="type">const</span> QString &amp;fileNameHint = QString())</span></span>;</span><br></pre></td></tr></table></figure><blockquote><p>示例见上一小节。</p></blockquote><br><h2 id="四-Q-amp-A"><a href="#四-Q-amp-A" class="headerlink" title="四 Q&amp;A"></a>四 Q&amp;A</h2><h3 id="4-1-信号与槽怎么通信？"><a href="#4-1-信号与槽怎么通信？" class="headerlink" title="4.1 信号与槽怎么通信？"></a>4.1 信号与槽怎么通信？</h3><p>就我个人来理解，信号槽机制与Windows下消息机制类似，消息机制是基于回调函数，Qt中用信号与槽来代替函数指针，使程序更安全简洁。</p><p>信号和槽机制是 Qt 的核心机制，可以让编程人员将互不相关的对象绑定在一起，实现对象之间的通信。</p><ul><li><strong>信号</strong>：当对象改变其状态时，信号就由该对象发射 【<code>emit</code>】 出去，而且对象只负责发送信号，它不知道另一端是谁在接收这个信号。这样就做到了真正的信息封装，能确保对象被当作一个真正的软件组件来使用。</li><li><strong>槽</strong>：用于接收信号，而且槽只是普通的对象成员函数。一个槽并不知道是否有任何信号与自己相连接，而且对象并不了解具体的通信机制。</li><li><strong>信号与槽的连接</strong>：所有从 <code>QObject</code> 或其子类【如 <code>Qwidget</code>】派生的类都能够包含信号和槽。因为信号与槽的连接是通过 <code>QObject</code> 的 <code>connect()</code> 成员函数来实现的。</li></ul><br><h3 id="4-2-信号和槽机制与Windows消息机制的异同"><a href="#4-2-信号和槽机制与Windows消息机制的异同" class="headerlink" title="4.2 信号和槽机制与Windows消息机制的异同"></a>4.2 信号和槽机制与Windows消息机制的异同</h3><p><code>Qt</code> 信号与槽机制是Qt框架中的一种事件通信机制，用于对象之间的通信。通过信号和槽的连接，一个对象可以发出信号，而其他对象可以通过连接的槽函数来接收并处理这个信号。这种机制实现了对象之间的松耦合，使得代码更加灵活和可维护。</p><p><code>Windows</code> 消息机制是Windows操作系统中的一种事件处理机制。在Windows中，各个窗口和控件都是通过消息进行通信和交互的。当用户进行操作时，例如点击鼠标或按下键盘，Windows会将相应的消息发送给对应的窗口或控件，然后窗口或控件可以根据接收到的消息来进行相应的处理。</p><p>两者的区别主要有以下几点：</p><ul><li>机制不同：Qt信号与槽是Qt框架提供的一种事件通信机制，而Windows消息机制是Windows操作系统提供的一种事件处理机制。</li><li>应用范围不同：Qt信号与槽机制主要用于Qt框架中的对象之间的通信，而Windows消息机制主要用于Windows操作系统中窗口和控件之间的通信。</li><li>实现方式不同：Qt信号与槽机制是通过函数指针和元对象系统来实现的，而Windows消息机制是通过消息队列和消息循环来实现的。</li><li>灵活性不同：Qt信号与槽机制可以实现多对多的连接，一个信号可以连接多个槽函数，一个槽函数也可以连接多个信号。而Windows消息机制是一对一的通信，一个消息只能发送给一个窗口或控件。</li></ul><br><h3 id="4-3-connect函数的连接方式"><a href="#4-3-connect函数的连接方式" class="headerlink" title="4.3 connect函数的连接方式"></a>4.3 <code>connect</code>函数的连接方式</h3><p><code>Qt</code> 中<code>connect</code>函数的第五个参数，决定了<code>Qt</code>信号和槽函数的连接方式。</p><p><code>connect</code>函数原型如下:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">static</span>] <span class="function">QMetaObject::Connection <span class="title">QObject::connect</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">const</span> QObject *sender,        <span class="comment">//发送者</span></span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">const</span> QMetaMethod &amp;signal,    <span class="comment">//信号</span></span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">const</span> QObject *receiver,    <span class="comment">//接收者</span></span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">const</span> QMetaMethod &amp;method,    <span class="comment">//槽函数</span></span></span></span><br><span class="line"><span class="params"><span class="function">    Qt::ConnectionType type = Qt::AutoConnection)</span></span>;    <span class="comment">//默认参数：连接方式</span></span><br><span class="line"><span class="comment">// connect的其他重载方式</span></span><br><span class="line"><span class="function">QMetaObject::Connection <span class="title">QObject::connect</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">const</span> QObject *sender,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">const</span> <span class="type">char</span> *signal,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">const</span> <span class="type">char</span> *method,</span></span></span><br><span class="line"><span class="params"><span class="function">    Qt::ConnectionType type = Qt::AutoConnection)</span> <span class="type">const</span></span>;</span><br></pre></td></tr></table></figure><p>第5个参数类型为Qt命名空间的<code>ConnectionType</code>枚举类型，该枚举描述信号和槽之间可以使用的连接类型，其决定了特定信号是立即传递给槽函数，还是排队等待一会儿传递给槽函数。</p><p>默认情况下，第五个参数是不用写的，使用的缺省值，是自动连接<code>Qt::AutoConnection</code>。当使用自动连接时，单线程的情况下，会自动切换到直接连接；而多线程的情况下，会切换到队列连接。</p><p><code>ConnectionType</code>枚举定义如下：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">ConnectionType</span> &#123;</span><br><span class="line">    AutoConnection,                <span class="comment">//=0</span></span><br><span class="line">    DirectConnection,            <span class="comment">//=1</span></span><br><span class="line">    QueuedConnection,            <span class="comment">//=2</span></span><br><span class="line">    BlockingQueuedConnection,    <span class="comment">//=3</span></span><br><span class="line">    UniqueConnection =  <span class="number">0x80</span>,    <span class="comment">//=0x80</span></span><br><span class="line">    SingleShotConnection        <span class="comment">//=0x100</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><code>ConnectionType</code>枚举值功能介绍：</p><ul><li><code>Qt::AutoConnection</code>：【默认值 | 自动连接】根据是否在同一线程来自动切换【实际的绑定类型在信号发出时决定】。<ul><li>如果信号是与接收对象同一线程发出的，视为直接连接【<code>Qt::DirectConnection</code>】，直接调用槽函数；</li><li>否则，视为队列连接【<code>Qt::QueuedConnection</code>】，把信号做排队处理。</li></ul></li><li><code>Qt::DirectConnection</code>：【直接连接】信号和槽函数在同一个线程中，发射完信号后立即调用槽函数<ul><li>单线程时使用，会同步阻塞执行。发信号之后，当槽函数执行结束，才能往下执行发射信号之后的代码。</li><li>也就是说，只用在槽函数执行完成后，发射信号后面的代码才可以执行，相当于阻塞模式。</li></ul></li><li><code>Qt::QueuedConnection</code>：【队列连接】信号和槽函数不在同一个线程中，当发送信号的线程发送信号后立即执行下面的代码，发送的信号会放到另一个线程的信号队列中等待获取执行。<ul><li>相当于一个异步非阻塞的效果，即不阻塞模式。</li><li>其实单线程、多线程都可以使用。</li></ul></li><li><code>Qt::BlockingQueuedConnection</code>：【阻塞队列连接】信号和槽不在一个线程中，发送信号的线程发送一个信号后，这个线程不会执行下面的代码，直到接收信号的线程中的槽函数执行完成返回后才会继续执行.<ul><li>必须是多线程的情况下使用，如果是单线程，则会发生死锁。</li></ul></li><li><code>Qt::UniqueConnection</code>：【唯一连接】用来防止相同的信号槽重复连接。<ul><li>一旦形成重复关联，信号一旦发射，就会有对应的槽函数多次执行。</li><li>不能单独使用，加上<code>|</code>配合上面其他连接方式使用。</li><li>使用时，如果同一对象的相同信号已经连接到相同的槽，那么连接将失败【Qt 4.6】。</li></ul></li><li><code>Qt::AutoCompatConnection</code>：是为了连接<code>Qt4</code>与<code>Qt3</code>的信号槽机制兼容方式，工作方式与自动连接相同。</li></ul><br><br><br><br><br><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css"></div><div class="reward-container"><div></div><button onclick='var qr=document.getElementById("qr");qr.style.display="none"===qr.style.display?"block":"none"'>打赏</button><div id="qr" style="display:none"><div style="display:inline-block"><img src="/images/wechatpay.png" alt="Moustache 微信支付"><p>微信支付</p></div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者： </strong>Moustache</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="https://hammerzer.github.io/2024/07/16/qt-Quick-Start/" title="Qt快速入门">https://hammerzer.github.io/2024/07/16/qt-Quick-Start/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%B8%8E%E6%A1%86%E6%9E%B6/" rel="tag"><i class="fa fa-tag"></i> 操作系统与框架</a> <a href="/tags/Qt/" rel="tag"><i class="fa fa-tag"></i> Qt</a></div><div class="post-nav"><div class="post-nav-item"><a href="/2024/06/29/One%20of%20the%20challenges%20in%20rapid%20development/" rel="prev" title="快速开发中的难题汇总之一"><i class="fa fa-chevron-left"></i> 快速开发中的难题汇总之一</a></div><div class="post-nav-item"><a href="/2024/08/07/qt-project-weather/" rel="next" title="Qt项目-Weather">Qt项目-Weather <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="valine-comments"></div><script>window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#CONTENT-OUTLINE"><span class="nav-number">1.</span> <span class="nav-text">CONTENT OUTLINE</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E3%80%87-%E7%9B%AE%E5%BD%95"><span class="nav-number">2.</span> <span class="nav-text">〇 目录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80-Qt%E5%85%A5%E9%97%A8%E7%AC%AC%E4%B8%80%E6%AD%A5"><span class="nav-number">3.</span> <span class="nav-text">一 Qt入门第一步</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-Qt-%E5%9F%BA%E6%9C%AC%E7%AE%80%E4%BB%8B"><span class="nav-number">3.1.</span> <span class="nav-text">1.1 Qt 基本简介</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-1-Qt%E7%9A%84%E5%8F%91%E5%B1%95"><span class="nav-number">3.1.1.</span> <span class="nav-text">1.1.1 Qt的发展</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-2-%E6%94%AF%E6%8C%81%E5%B9%B3%E5%8F%B0"><span class="nav-number">3.1.2.</span> <span class="nav-text">1.1.2 支持平台</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-3-Qt%E7%9A%84%E7%89%88%E6%9C%AC"><span class="nav-number">3.1.3.</span> <span class="nav-text">1.1.3 Qt的版本</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-4-Qt-Creator"><span class="nav-number">3.1.4.</span> <span class="nav-text">1.1.4 Qt Creator</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-5-Qt%E7%9A%84%E4%BC%98%E7%82%B9"><span class="nav-number">3.1.5.</span> <span class="nav-text">1.1.5 Qt的优点</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-Qt5%E7%9A%84%E5%AE%89%E8%A3%85"><span class="nav-number">3.2.</span> <span class="nav-text">1.2 Qt5的安装</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-1-%E4%B8%8B%E8%BD%BDQt5"><span class="nav-number">3.2.1.</span> <span class="nav-text">1.2.1 下载Qt5</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-2-Qt%E5%AE%89%E8%A3%85"><span class="nav-number">3.2.2.</span> <span class="nav-text">1.2.2 Qt安装</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-%E7%BC%96%E5%86%99Qt%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%E7%A8%8B%E5%BA%8F"><span class="nav-number">3.3.</span> <span class="nav-text">1.3 编写Qt的第一个程序</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-3-1-%E6%96%B0%E5%BB%BA%E9%A1%B9%E7%9B%AE"><span class="nav-number">3.3.1.</span> <span class="nav-text">1.3.1 新建项目</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-3-2-%E7%BC%96%E8%BE%91%E6%A8%A1%E5%BC%8F"><span class="nav-number">3.3.2.</span> <span class="nav-text">1.3.2 编辑模式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-3-3-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F"><span class="nav-number">3.3.3.</span> <span class="nav-text">1.3.3 设计模式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-3-4-%E8%BF%90%E8%A1%8C%E9%A1%B9%E7%9B%AE"><span class="nav-number">3.3.4.</span> <span class="nav-text">1.3.4 运行项目</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-Qt%E9%A1%B9%E7%9B%AE%E6%96%87%E4%BB%B6%E4%BB%8B%E7%BB%8D"><span class="nav-number">3.4.</span> <span class="nav-text">1.4 Qt项目文件介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-4-1-%E6%96%B0%E5%BB%BA%E5%B7%A5%E7%A8%8B%E7%95%8C%E9%9D%A2%E8%AF%A6%E8%A7%A3"><span class="nav-number">3.4.1.</span> <span class="nav-text">1.4.1 新建工程界面详解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-4-2-%E9%A1%B9%E7%9B%AE%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3"><span class="nav-number">3.4.2.</span> <span class="nav-text">1.4.2 项目文件详解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-4-3-%E8%B0%83%E8%AF%95%E5%99%A8%E9%97%AE%E9%A2%98"><span class="nav-number">3.4.3.</span> <span class="nav-text">1.4.3 调试器问题</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-5-Qt-Creator%E5%BF%AB%E6%8D%B7%E9%94%AE"><span class="nav-number">3.5.</span> <span class="nav-text">1.5 Qt Creator快捷键</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-6-Qt-Creator%E4%BB%A3%E7%A0%81%E6%A0%BC%E5%BC%8F%E5%8C%96"><span class="nav-number">3.6.</span> <span class="nav-text">1.6 Qt Creator代码格式化</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C-Qt%E5%BC%80%E5%8F%91%E5%BF%85%E5%A4%87%E7%9A%84%E7%9F%A5%E8%AF%86%E5%82%A8%E5%A4%87"><span class="nav-number">4.</span> <span class="nav-text">二 Qt开发必备的知识储备</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-QPushButton%E7%AE%80%E4%BB%8B"><span class="nav-number">4.1.</span> <span class="nav-text">2.1 QPushButton简介</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-1-%E5%88%9B%E5%BB%BA%E6%8C%89%E9%92%AE"><span class="nav-number">4.1.1.</span> <span class="nav-text">2.1.1 创建按钮</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-2-%E8%AE%BE%E7%BD%AE%E6%8C%89%E9%92%AE%E5%8F%82%E6%95%B0"><span class="nav-number">4.1.2.</span> <span class="nav-text">2.1.2 设置按钮参数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-3-%E9%80%9A%E8%BF%87ui%E6%96%87%E4%BB%B6%E5%88%9B%E5%BB%BA%E6%8C%89%E9%92%AE"><span class="nav-number">4.1.3.</span> <span class="nav-text">2.1.3 通过ui文件创建按钮</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-%E5%B8%AE%E5%8A%A9%E6%96%87%E6%A1%A3%EF%BC%9AQt%E5%8A%A9%E6%89%8B%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">4.2.</span> <span class="nav-text">2.2 帮助文档：Qt助手的使用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E6%89%BE%E7%B4%A2%E5%BC%95"><span class="nav-number">4.2.1.</span> <span class="nav-text">查找索引</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-Qt%E5%AF%B9%E8%B1%A1%E6%A0%91%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="nav-number">4.3.</span> <span class="nav-text">2.3 Qt对象树的概念</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%AF%B9%E8%B1%A1%E6%A0%91%EF%BC%9F"><span class="nav-number">4.3.1.</span> <span class="nav-text">什么是对象树？</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%AF%B9%E8%B1%A1%E6%A0%91%E6%A8%A1%E5%BC%8F%E6%9C%89%E4%BB%80%E4%B9%88%E5%A5%BD%E5%A4%84%EF%BC%9F"><span class="nav-number">4.3.2.</span> <span class="nav-text">使用对象树模式有什么好处？</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AF%B9%E8%B1%A1%E6%A0%91%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-number">4.3.3.</span> <span class="nav-text">对象树的问题</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-%F0%9F%94%BAQt%E4%B8%AD%E4%BF%A1%E5%8F%B7%E5%92%8C%E6%A7%BD"><span class="nav-number">4.4.</span> <span class="nav-text">2.4 🔺Qt中信号和槽</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-1-%E4%BF%A1%E5%8F%B7%E3%80%90Signal%E3%80%91"><span class="nav-number">4.4.1.</span> <span class="nav-text">2.4.1 信号【Signal】</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-2-%E6%A7%BD%E3%80%90Slot%E3%80%91"><span class="nav-number">4.4.2.</span> <span class="nav-text">2.4.2 槽【Slot】</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-5-Qt%E4%B8%AD%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BF%A1%E5%8F%B7%E5%92%8C%E6%A7%BD%E5%87%BD%E6%95%B0"><span class="nav-number">4.5.</span> <span class="nav-text">2.5 Qt中自定义信号和槽函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-1-%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BF%A1%E5%8F%B7%E5%92%8C%E6%A7%BD"><span class="nav-number">4.5.1.</span> <span class="nav-text">2.5.1 自定义信号和槽</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-2-%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BF%A1%E5%8F%B7%E5%B8%A6%E5%8F%82%E6%95%B0%E9%87%8D%E8%BD%BD%E9%97%AE%E9%A2%98"><span class="nav-number">4.5.2.</span> <span class="nav-text">2.5.2 自定义信号带参数重载问题</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-7-%E4%BF%A1%E5%8F%B7%E5%92%8C%E6%A7%BD%E7%9A%84%E6%89%A9%E5%B1%95"><span class="nav-number">4.6.</span> <span class="nav-text">2.7 信号和槽的扩展</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-7-1-%E4%BF%A1%E5%8F%B7%E8%BF%9E%E6%8E%A5%E4%BF%A1%E5%8F%B7"><span class="nav-number">4.6.1.</span> <span class="nav-text">2.7.1 信号连接信号</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-7-2-%E4%BF%A1%E5%8F%B7%E7%9A%84%E6%96%AD%E5%BC%80"><span class="nav-number">4.6.2.</span> <span class="nav-text">2.7.2 信号的断开</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-7-3-%E5%B0%8F%E7%BB%93"><span class="nav-number">4.6.3.</span> <span class="nav-text">2.7.3 小结</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-8-Lambda%E5%87%BD%E6%95%B0"><span class="nav-number">4.7.</span> <span class="nav-text">2.8 Lambda函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-8-1-%E5%9F%BA%E6%9C%AC%E8%AE%A4%E8%AF%86"><span class="nav-number">4.7.1.</span> <span class="nav-text">2.8.1 基本认识</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-8-2-Lambda%E5%87%BD%E6%95%B0%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="nav-number">4.7.2.</span> <span class="nav-text">2.8.2 Lambda函数的基本使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-8-3-Lambda%E5%87%BD%E6%95%B0%E6%89%A9%E5%B1%95"><span class="nav-number">4.7.3.</span> <span class="nav-text">2.8.3 Lambda函数扩展</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-Lambda%E7%9A%84%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="nav-number">4.7.3.1.</span> <span class="nav-text">1 Lambda的返回值</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-Lambda%E7%9A%84%E5%BA%94%E7%94%A8"><span class="nav-number">4.7.3.2.</span> <span class="nav-text">2 Lambda的应用</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-QString%E8%BD%ACchar"><span class="nav-number">4.7.3.3.</span> <span class="nav-text">3 QString转char*</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4-Lambda%E4%BD%BF%E4%BB%A3%E7%A0%81%E7%AE%80%E6%B4%81%E9%AB%98%E6%95%88"><span class="nav-number">4.7.3.4.</span> <span class="nav-text">4 Lambda使代码简洁高效</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-8-4-Lambda%E5%87%BD%E6%95%B0QA"><span class="nav-number">4.7.4.</span> <span class="nav-text">2.8.4 Lambda函数QA</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89-%E5%B8%B8%E7%94%A8%E6%8E%A7%E4%BB%B6%E5%92%8C%E7%B1%BB"><span class="nav-number">5.</span> <span class="nav-text">三 常用控件和类</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-QTextEdit%E6%8E%A7%E4%BB%B6"><span class="nav-number">5.1.</span> <span class="nav-text">3.1 QTextEdit控件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-1-1-QTextEdit%E7%B1%BB%E5%8F%8A%E5%88%9D%E6%AD%A5%E4%BD%BF%E7%94%A8"><span class="nav-number">5.1.1.</span> <span class="nav-text">3.1.1 QTextEdit类及初步使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-1-2-QTextEdit%E7%9A%84%E4%BF%A1%E5%8F%B7"><span class="nav-number">5.1.2.</span> <span class="nav-text">3.1.2 QTextEdit的信号</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-QMainWindow"><span class="nav-number">5.2.</span> <span class="nav-text">3.2 QMainWindow</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-2-1-%E8%8F%9C%E5%8D%95%E6%A0%8F-MenuBar"><span class="nav-number">5.2.1.</span> <span class="nav-text">3.2.1 菜单栏 MenuBar</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-2-2-%E5%B7%A5%E5%85%B7%E6%A0%8F-ToolBar"><span class="nav-number">5.2.2.</span> <span class="nav-text">3.2.2 工具栏 ToolBar</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-2-3-%E7%8A%B6%E6%80%81%E6%A0%8F-QStatusBar"><span class="nav-number">5.2.3.</span> <span class="nav-text">3.2.3 状态栏 QStatusBar</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-2-4-%E4%B8%AD%E6%96%87%E5%A5%87%E6%95%B0%E4%B9%B1%E7%A0%81%E6%88%96%E7%9B%B4%E6%8E%A5%E4%B9%B1%E7%A0%81%E9%97%AE%E9%A2%98"><span class="nav-number">5.2.4.</span> <span class="nav-text">3.2.4 中文奇数乱码或直接乱码问题</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-2-5-%E9%93%86%E6%8E%A5%E9%83%A8%E4%BB%B6-%E6%B5%AE%E5%8A%A8%E7%AA%97%E5%8F%A3-QDockWidget"><span class="nav-number">5.2.5.</span> <span class="nav-text">3.2.5 铆接部件 浮动窗口 QDockWidget</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-UI%E8%AE%BE%E8%AE%A1%E5%99%A8%E4%BB%8B%E7%BB%8D"><span class="nav-number">5.3.</span> <span class="nav-text">3.3 UI设计器介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-%E6%B7%BB%E5%8A%A0%E5%9B%BE%E6%A0%87Icon"><span class="nav-number">5.4.</span> <span class="nav-text">3.4 添加图标Icon</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-4-1-%E4%BB%A3%E7%A0%81%E6%96%B9%E5%BC%8F%E6%B7%BB%E5%8A%A0%E5%9B%BE%E6%A0%87"><span class="nav-number">5.4.1.</span> <span class="nav-text">3.4.1 代码方式添加图标</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-4-2-%E6%B7%BB%E5%8A%A0%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6"><span class="nav-number">5.4.2.</span> <span class="nav-text">3.4.2 添加资源文件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-5-%E5%AF%B9%E8%AF%9D%E6%A1%86-Dialog"><span class="nav-number">5.5.</span> <span class="nav-text">3.5 对话框 Dialog</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-5-1-%E6%A0%87%E5%87%86%E5%AF%B9%E8%AF%9D%E6%A1%86"><span class="nav-number">5.5.1.</span> <span class="nav-text">3.5.1 标准对话框</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-5-2-%E6%A8%A1%E6%80%81%E5%92%8C%E9%9D%9E%E6%A8%A1%E6%80%81%E5%AF%B9%E8%AF%9D%E6%A1%86"><span class="nav-number">5.5.2.</span> <span class="nav-text">3.5.2 模态和非模态对话框</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-5-3-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%B9%E8%AF%9D%E6%A1%86"><span class="nav-number">5.5.3.</span> <span class="nav-text">3.5.3 自定义对话框</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-5-4-QMessageBox%E5%AF%B9%E8%AF%9D%E6%A1%86"><span class="nav-number">5.5.4.</span> <span class="nav-text">3.5.4 QMessageBox对话框</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-6-%E5%9F%BA%E6%9C%AC%E5%AF%B9%E8%AF%9D%E6%A1%86"><span class="nav-number">5.6.</span> <span class="nav-text">3.6 基本对话框</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-6-1-%E9%80%89%E6%8B%A9%E9%A2%9C%E8%89%B2%E5%AF%B9%E8%AF%9D%E6%A1%86-QColorDialog"><span class="nav-number">5.6.1.</span> <span class="nav-text">3.6.1 选择颜色对话框 QColorDialog</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-6-2-%E6%96%87%E4%BB%B6%E9%80%89%E6%8B%A9%E5%AF%B9%E8%AF%9D%E6%A1%86-QFileDialog"><span class="nav-number">5.6.2.</span> <span class="nav-text">3.6.2 文件选择对话框 QFileDialog</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9B%9B-Q-amp-A"><span class="nav-number">6.</span> <span class="nav-text">四 Q&amp;A</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-%E4%BF%A1%E5%8F%B7%E4%B8%8E%E6%A7%BD%E6%80%8E%E4%B9%88%E9%80%9A%E4%BF%A1%EF%BC%9F"><span class="nav-number">6.1.</span> <span class="nav-text">4.1 信号与槽怎么通信？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-%E4%BF%A1%E5%8F%B7%E5%92%8C%E6%A7%BD%E6%9C%BA%E5%88%B6%E4%B8%8EWindows%E6%B6%88%E6%81%AF%E6%9C%BA%E5%88%B6%E7%9A%84%E5%BC%82%E5%90%8C"><span class="nav-number">6.2.</span> <span class="nav-text">4.2 信号和槽机制与Windows消息机制的异同</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-connect%E5%87%BD%E6%95%B0%E7%9A%84%E8%BF%9E%E6%8E%A5%E6%96%B9%E5%BC%8F"><span class="nav-number">6.3.</span> <span class="nav-text">4.3 connect函数的连接方式</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Moustache" src="/images/180-180.png"><p class="site-author-name" itemprop="name">Moustache</p><div class="site-description" itemprop="description">我是小胡子</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">78</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">9</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">34</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/hammerzer" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;hammerzer" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:stellar_lzu@163.com" title="E-Mail → mailto:stellar_lzu@163.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a></span></div><div class="cc-license motion-element" itemprop="license"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a></div></div><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2025</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Chase</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-chart-area"></i> </span><span class="post-meta-item-text">站点总字数：</span> <span title="站点总字数">1.9m</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span class="post-meta-item-text">站点阅读时长 &asymp;</span> <span title="站点阅读时长">29:01</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span> </span></span><span class="post-meta-divider">|</span> <span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer></div><script size="300" alpha="0.4" zindex="-1" src="//cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-ribbon@1/canvas-ribbon.js"></script><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><script>NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/valine@1/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'JRehDoQ6pHXV1zKg09AMNLFt-gzGzoHsz',
      appKey     : 'cRAt4W15KiQdrIuHlQrRrtIl',
      placeholder: "Just go go",
      avatar     : 'wavatar',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : true,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : true,
      serverURLs : ''
    });
  }, window.Valine);
});</script></body></html>